<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Robin Genuer &amp; Boris Hejblum">
<meta name="dcterms.date" content="2024-06-06">
<title>SAVOR: Part III</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="SAVOR_practical3_files/libs/clipboard/clipboard.min.js"></script>
<script src="SAVOR_practical3_files/libs/quarto-html/quarto.js"></script>
<script src="SAVOR_practical3_files/libs/quarto-html/popper.min.js"></script>
<script src="SAVOR_practical3_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="SAVOR_practical3_files/libs/quarto-html/anchor.min.js"></script>
<link href="SAVOR_practical3_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="SAVOR_practical3_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="SAVOR_practical3_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="SAVOR_practical3_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="SAVOR_practical3_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
</head>
<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li><a href="#objectifs" id="toc-objectifs" class="nav-link active" data-scroll-target="#objectifs">Objectifs</a></li>
  <li>
<a href="#introduction-%C3%A0-dplyr" id="toc-introduction-à-dplyr" class="nav-link" data-scroll-target="#introduction-%C3%A0-dplyr">Introduction à <code>dplyr</code></a>
  <ul class="collapse">
<li>
<a href="#gestion-de-fichiers-de-donn%C3%A9es" id="toc-gestion-de-fichiers-de-données" class="nav-link" data-scroll-target="#gestion-de-fichiers-de-donn%C3%A9es">Gestion de fichiers de données</a>
  <ul class="collapse">
<li><a href="#importation" id="toc-importation" class="nav-link" data-scroll-target="#importation">Importation</a></li>
  <li><a href="#exportation" id="toc-exportation" class="nav-link" data-scroll-target="#exportation">Exportation</a></li>
  <li><a href="#sauvegarde" id="toc-sauvegarde" class="nav-link" data-scroll-target="#sauvegarde">Sauvegarde</a></li>
  </ul>
</li>
  <li>
<a href="#op%C3%A9rations-sur-les-tableaux-de-donn%C3%A9es" id="toc-opérations-sur-les-tableaux-de-données" class="nav-link" data-scroll-target="#op%C3%A9rations-sur-les-tableaux-de-donn%C3%A9es">Opérations sur les tableaux de données</a>
  <ul class="collapse">
<li><a href="#s%C3%A9lection-suppression-ajout" id="toc-sélection-suppression-ajout" class="nav-link" data-scroll-target="#s%C3%A9lection-suppression-ajout">Sélection, suppression, ajout</a></li>
  <li><a href="#fusion" id="toc-fusion" class="nav-link" data-scroll-target="#fusion">Fusion</a></li>
  <li><a href="#trier-un-tableau-de-donn%C3%A9es-le-long-dune-colonne" id="toc-trier-un-tableau-de-données-le-long-dune-colonne" class="nav-link" data-scroll-target="#trier-un-tableau-de-donn%C3%A9es-le-long-dune-colonne">Trier un tableau de données le long d’une colonne</a></li>
  <li><a href="#la-classe-tlb" id="toc-la-classe-tlb" class="nav-link" data-scroll-target="#la-classe-tlb">La classe <code>tlb</code></a></li>
  </ul>
</li>
  </ul>
</li>
  <li><a href="#introduction-au-pipe" id="toc-introduction-au-pipe" class="nav-link" data-scroll-target="#introduction-au-pipe">Introduction au pipe <code>%&gt;%</code></a></li>
  <li><a href="#r%C3%A9sum%C3%A9" id="toc-résumé" class="nav-link" data-scroll-target="#r%C3%A9sum%C3%A9">Résumé</a></li>
  </ul></nav>
</div>
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">SAVOR: Part III</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
<p class="subtitle lead"><code>dplyr</code> and <code>%&gt;%</code></p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Robin Genuer &amp; Boris Hejblum </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">June 6, 2024</p>
    </div>
  </div>
  
    
  </div>
  

</header><section id="objectifs" class="level1"><h1>Objectifs</h1>
<p>Ce document donne tout d’abord quelques considérations sur l’importation de données et sur les strucutres de bases de R, avant de donner quelques éléments introductifs sur l’utilisation du package <code>dplyr</code>.</p>
</section><section id="introduction-à-dplyr" class="level1"><h1>Introduction à <code>dplyr</code>
</h1>
<p>Il existe un très grand nombre de packages additionnels dans <svg aria-hidden="true" role="img" viewbox="0 0 581 512" style="height:1em;width:1.13em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:currentColor;overflow:visible;position:relative;"><path d="M581 226.6C581 119.1 450.9 32 290.5 32S0 119.1 0 226.6C0 322.4 103.3 402 239.4 418.1V480h99.1v-61.5c24.3-2.7 47.6-7.4 69.4-13.9L448 480h112l-67.4-113.7c54.5-35.4 88.4-84.9 88.4-139.7zm-466.8 14.5c0-73.5 98.9-133 220.8-133s211.9 40.7 211.9 133c0 50.1-26.5 85-70.3 106.4-2.4-1.6-4.7-2.9-6.4-3.7-10.2-5.2-27.8-10.5-27.8-10.5s86.6-6.4 86.6-92.7-90.6-87.9-90.6-87.9h-199V361c-74.1-21.5-125.2-67.1-125.2-119.9zm225.1 38.3v-55.6c57.8 0 87.8-6.8 87.8 27.3 0 36.5-38.2 28.3-87.8 28.3zm-.9 72.5H365c10.8 0 18.9 11.7 24 19.2-16.1 1.9-33 2.8-50.6 2.9v-22.1z"></path></svg>. Certains apportent de nouvelles fonctionnalités (méthodes statistiques qui n’étaient pas disponible auparavant), et d’autres apportent des améliorations à des fonctionnalités déjà présentes dans <svg aria-hidden="true" role="img" viewbox="0 0 581 512" style="height:1em;width:1.13em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:currentColor;overflow:visible;position:relative;"><path d="M581 226.6C581 119.1 450.9 32 290.5 32S0 119.1 0 226.6C0 322.4 103.3 402 239.4 418.1V480h99.1v-61.5c24.3-2.7 47.6-7.4 69.4-13.9L448 480h112l-67.4-113.7c54.5-35.4 88.4-84.9 88.4-139.7zm-466.8 14.5c0-73.5 98.9-133 220.8-133s211.9 40.7 211.9 133c0 50.1-26.5 85-70.3 106.4-2.4-1.6-4.7-2.9-6.4-3.7-10.2-5.2-27.8-10.5-27.8-10.5s86.6-6.4 86.6-92.7-90.6-87.9-90.6-87.9h-199V361c-74.1-21.5-125.2-67.1-125.2-119.9zm225.1 38.3v-55.6c57.8 0 87.8-6.8 87.8 27.3 0 36.5-38.2 28.3-87.8 28.3zm-.9 72.5H365c10.8 0 18.9 11.7 24 19.2-16.1 1.9-33 2.8-50.6 2.9v-22.1z"></path></svg>.</p>
<p>Le package <code>dplyr</code> rentre essentiellement dans la 2<sup>ème</sup> catégorie. Il propose de re-définir la manipulation de données dans R, avec une syntaxe plus simple, tout en améliorant les performances lorsqu’on gère des grands tableaux de données.</p>
<p>Installer le package <code>dplyr</code> puis le charger :</p>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># install.packages('dplyr')</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="gestion-de-fichiers-de-données" class="level2"><h2 class="anchored" data-anchor-id="gestion-de-fichiers-de-données">Gestion de fichiers de données</h2>
<p>Avant de se lancer dans l’utilisation de <code>dplyr</code>, nous allons revoir quelques principes dans la gestion des fichiers de données sous <svg aria-hidden="true" role="img" viewbox="0 0 581 512" style="height:1em;width:1.13em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:currentColor;overflow:visible;position:relative;"><path d="M581 226.6C581 119.1 450.9 32 290.5 32S0 119.1 0 226.6C0 322.4 103.3 402 239.4 418.1V480h99.1v-61.5c24.3-2.7 47.6-7.4 69.4-13.9L448 480h112l-67.4-113.7c54.5-35.4 88.4-84.9 88.4-139.7zm-466.8 14.5c0-73.5 98.9-133 220.8-133s211.9 40.7 211.9 133c0 50.1-26.5 85-70.3 106.4-2.4-1.6-4.7-2.9-6.4-3.7-10.2-5.2-27.8-10.5-27.8-10.5s86.6-6.4 86.6-92.7-90.6-87.9-90.6-87.9h-199V361c-74.1-21.5-125.2-67.1-125.2-119.9zm225.1 38.3v-55.6c57.8 0 87.8-6.8 87.8 27.3 0 36.5-38.2 28.3-87.8 28.3zm-.9 72.5H365c10.8 0 18.9 11.7 24 19.2-16.1 1.9-33 2.8-50.6 2.9v-22.1z"></path></svg>.</p>
<section id="importation" class="level3"><h3 class="anchored" data-anchor-id="importation">Importation</h3>
<p>Le plus simple pour importer des données est d’utiliser l’outil graphique de Rstudio “Import Dataset”, présent dans l’onglet “Environnement” ou dans le menu “File”.</p>
<p>Sinon, on peut bien entendu utiliser la fonction <code><a href="https://rdrr.io/r/utils/read.table.html">read.table()</a></code> et ses dérivées (<code><a href="https://rdrr.io/r/utils/read.table.html">read.csv()</a></code>, <code><a href="https://rdrr.io/r/utils/read.table.html">read.delim()</a></code>…).</p>
<p>Importer le fichier <code>naissance.txt</code>, puis regarder la structure du tableau créé via la fonction <code><a href="https://rdrr.io/r/utils/str.html">str()</a></code>.</p>
<p><svg aria-hidden="true" role="img" viewbox="0 0 581 512" style="height:1em;width:1.13em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:currentColor;overflow:visible;position:relative;"><path d="M581 226.6C581 119.1 450.9 32 290.5 32S0 119.1 0 226.6C0 322.4 103.3 402 239.4 418.1V480h99.1v-61.5c24.3-2.7 47.6-7.4 69.4-13.9L448 480h112l-67.4-113.7c54.5-35.4 88.4-84.9 88.4-139.7zm-466.8 14.5c0-73.5 98.9-133 220.8-133s211.9 40.7 211.9 133c0 50.1-26.5 85-70.3 106.4-2.4-1.6-4.7-2.9-6.4-3.7-10.2-5.2-27.8-10.5-27.8-10.5s86.6-6.4 86.6-92.7-90.6-87.9-90.6-87.9h-199V361c-74.1-21.5-125.2-67.1-125.2-119.9zm225.1 38.3v-55.6c57.8 0 87.8-6.8 87.8 27.3 0 36.5-38.2 28.3-87.8 28.3zm-.9 72.5H365c10.8 0 18.9 11.7 24 19.2-16.1 1.9-33 2.8-50.6 2.9v-22.1z"></path></svg> considère toutes les variables comme des suite de nombres entiers (car effectivement il n’y a pas de nombres à virgule), ce qui est correcte pour les variables quantitatives (comme l’âge ou encore le poids de l’enfant <code>BWT</code>). Par contre, certaines variables sont qualitatives (comme <code>SMOKE</code>), donc si on veut des facteurs, il faut le forcer.</p>
<p>Transformer la variable <code>SMOKE</code> en facteur, et renommer les niveaux en “Non-Fumeur” (0 dans le fichier txt) et “Fumeur” (1 dans le fichier txt).</p>
<section id="exercice-0" class="level4"><h4 class="anchored" data-anchor-id="exercice-0">Exercice 0 :</h4>
<ol type="1">
<li><p>Charger le fichier de données nommé <code>naissance_na.txt</code>.</p></li>
<li><p>Consulter la structure de l’objet créé (par exemple nommé <code>naissance_na</code>). Que remarquez-vous pour la variable <code>LWT</code> ?</p></li>
<li><p>Pour régler le problème, modifier le contenu de la case “NA.strings” lors du chargement du fichier de données avec “Import Dataset” (ou modifier le paramètre <code>na.strings</code> de la fonction <code><a href="https://rdrr.io/r/utils/read.table.html">read.table()</a></code> ou de ses dérivées). Puis vérifier la nouvelle structure de l’objet.</p></li>
<li><p>A l’aide de la fonction <code><a href="https://rdrr.io/r/base/transform.html">transform()</a></code>, transformer en facteur les variables <code>RACE</code> (1=blanche, 2=noire, 3=autres), <code>HT</code> (0=non, 1=oui) et <code>UI</code> (0=non, 1=oui) en une seule commande.</p></li>
<li>
<p>Toujours à l’aide de la fonction <code><a href="https://rdrr.io/r/base/transform.html">transform()</a></code>, créer deux nouvelles variables (utiliser deux commandes différentes, puis essayer en une seule fois) :</p>
<ul>
<li><p><code>POIDS</code>, contenant le poids de la mère en g (1 livre = 453 g).</p></li>
<li><p><code>RAPPORT</code>, contenant le rapport entre le poids de l’enfant et celui de la mère (en grammes tous les deux).</p></li>
</ul>
</li>
<li><p>Utiliser la fonction <code><a href="https://dplyr.tidyverse.org/reference/mutate.html">dplyr::mutate()</a></code> (du package <code>dplyr</code>) pour répondre à la question précédente en une seule commande.</p></li>
</ol></section></section><section id="exportation" class="level3"><h3 class="anchored" data-anchor-id="exportation">Exportation</h3>
<p>Pour écrire une table de données, on utilise la fonction <code><a href="https://rdrr.io/r/utils/write.table.html">write.table()</a></code> ou ses dérivées.</p>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mon_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>Partie <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Intro"</span>, <span class="st">"Bases"</span>, <span class="st">"Manip"</span><span class="op">)</span>, Temps <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">1.5</span>, <span class="fl">1.5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">mon_df</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>  Partie Temps
1  Intro   0.5
2  Bases   1.5
3  Manip   1.5</code></pre>
</div>
<details><summary>Code</summary><div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/write.table.html">write.csv</a></span><span class="op">(</span><span class="va">mon_df</span>, file <span class="op">=</span> <span class="st">"mon_df.csv"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="sauvegarde" class="level3"><h3 class="anchored" data-anchor-id="sauvegarde">Sauvegarde</h3>
<p>On peut aussi sauvegarder une table au format <code>Rdata</code> (qui est un format propre à R). Pour cela on utilise <code><a href="https://rdrr.io/r/base/save.html">save()</a></code> :</p>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/save.html">save</a></span><span class="op">(</span><span class="va">naissance</span>, file <span class="op">=</span> <span class="st">"naissance.Rdata"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>L’avantage est que lorsqu’on recharge le fichier avec la fonction <code><a href="https://rdrr.io/r/base/load.html">load()</a></code>, il garde la bonne structure :</p>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/rm.html">rm</a></span><span class="op">(</span><span class="va">naissance</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/load.html">load</a></span><span class="op">(</span><span class="st">"naissance.Rdata"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">naissance</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   189 obs. of  10 variables:
 $ ID   : int  85 86 87 88 89 91 92 93 94 95 ...
 $ AGE  : int  19 33 20 21 18 21 22 17 29 26 ...
 $ LWT  : int  182 155 105 108 107 124 118 103 123 113 ...
 $ RACE : int  2 3 1 1 1 3 1 3 1 1 ...
 $ SMOKE: Factor w/ 2 levels "Non-Fumeur","Fumeur": 1 1 2 2 2 1 1 1 2 2 ...
 $ PTL  : int  0 0 0 0 0 0 0 0 0 0 ...
 $ HT   : int  0 0 0 0 0 0 0 0 0 0 ...
 $ UI   : int  1 0 0 1 1 0 0 0 0 0 ...
 $ FVT  : int  0 3 1 2 0 0 1 1 1 0 ...
 $ BWT  : int  2523 2551 2557 2594 2600 2622 2637 2637 2663 2665 ...</code></pre>
</div>
</div>
<p>On remarque qu’on a pas besoin d’affecter le résultat de <code><a href="https://rdrr.io/r/base/load.html">load()</a></code> à un objet. Ceci est dû au fait, qu’on peut sauvegarder plusieurs objets de la session dans un même fichier <code>.Rdata</code>. Et on pourra tous les recharger ensuite :</p>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/save.html">save</a></span><span class="op">(</span><span class="va">naissance</span>, <span class="va">mon_df</span>, file <span class="op">=</span> <span class="st">"naissance_mon_df.Rdata"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/rm.html">rm</a></span><span class="op">(</span><span class="va">naissance</span>, <span class="va">mon_df</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">mon_df</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-error">
<pre><code>Error in eval(expr, envir, enclos): object 'mon_df' not found</code></pre>
</div>
<details><summary>Code</summary><div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/load.html">load</a></span><span class="op">(</span><span class="st">"naissance_mon_df.Rdata"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">mon_df</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "data.frame"</code></pre>
</div>
</div>
<p>Ce comportement est pratique, mais peut parfois s’avérer trompeur. Si on a beaucoup d’objets dans notre environnement, et qu’on charge un objet <code>.Rdata</code> avec plusieurs objets (dont on ne se souvient pas, ou dont on ne connaît pas le nom), il est difficile de s’y retrouver. De plus, lors du chargement, <svg aria-hidden="true" role="img" viewbox="0 0 581 512" style="height:1em;width:1.13em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:currentColor;overflow:visible;position:relative;"><path d="M581 226.6C581 119.1 450.9 32 290.5 32S0 119.1 0 226.6C0 322.4 103.3 402 239.4 418.1V480h99.1v-61.5c24.3-2.7 47.6-7.4 69.4-13.9L448 480h112l-67.4-113.7c54.5-35.4 88.4-84.9 88.4-139.7zm-466.8 14.5c0-73.5 98.9-133 220.8-133s211.9 40.7 211.9 133c0 50.1-26.5 85-70.3 106.4-2.4-1.6-4.7-2.9-6.4-3.7-10.2-5.2-27.8-10.5-27.8-10.5s86.6-6.4 86.6-92.7-90.6-87.9-90.6-87.9h-199V361c-74.1-21.5-125.2-67.1-125.2-119.9zm225.1 38.3v-55.6c57.8 0 87.8-6.8 87.8 27.3 0 36.5-38.2 28.3-87.8 28.3zm-.9 72.5H365c10.8 0 18.9 11.7 24 19.2-16.1 1.9-33 2.8-50.6 2.9v-22.1z"></path></svg> peut écraser des objets déjà présents avec le même nom.</p>
<p><strong>Conseil</strong> : mettre tout ce qu’on veut sauver dans une liste, et sauver cette liste sous format <code>.Rdata</code> en gardant le même nom :</p>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">naissance_mon_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>naissance <span class="op">=</span> <span class="va">naissance</span>, mon_df <span class="op">=</span> <span class="va">mon_df</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/save.html">save</a></span><span class="op">(</span><span class="va">naissance_mon_df</span>, file <span class="op">=</span> <span class="st">"naissance_mon_df.Rdata"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/rm.html">rm</a></span><span class="op">(</span><span class="va">naissance_mon_df</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/load.html">load</a></span><span class="op">(</span><span class="st">"naissance_mon_df.Rdata"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section></section><section id="opérations-sur-les-tableaux-de-données" class="level2"><h2 class="anchored" data-anchor-id="opérations-sur-les-tableaux-de-données">Opérations sur les tableaux de données</h2>
<section id="sélection-suppression-ajout" class="level3"><h3 class="anchored" data-anchor-id="sélection-suppression-ajout">Sélection, suppression, ajout</h3>
<section id="exercice-1-sélection-de-colonnes" class="level4"><h4 class="anchored" data-anchor-id="exercice-1-sélection-de-colonnes">Exercice 1 : Sélection de colonnes</h4>
<ol type="1">
<li><p>J’ai dénombré 10 façons de sélectionner la variable <code>AGE</code>. En gardant en tête qu’un <code>data.frame</code> est une liste de colonnes, essayer d’en trouver un maximum.</p></li>
<li><p>Utiliser la fonction <code>select</code> du package <code>dplyr</code> pour sélectionner la variable <code>AGE</code> et regarder comment elle se comporte.</p></li>
</ol></section><section id="exercice-2-sélection-de-plusieurs-colonnes" class="level4"><h4 class="anchored" data-anchor-id="exercice-2-sélection-de-plusieurs-colonnes">Exercice 2 : Sélection de plusieurs colonnes</h4>
<p>Essayer tous les commandes précédentes pour extraire, en même temps, les 4 colonnes <code>ID</code>, <code>AGE</code>, <code>LWT</code> et <code>SMOKE</code>.</p>
</section><section id="exercice-3-sélection-de-lignes" class="level4"><h4 class="anchored" data-anchor-id="exercice-3-sélection-de-lignes">Exercice 3 : Sélection de lignes</h4>
<p>Sélectionner les 5 premières lignes, puis les 5 dernières lignes (en 2 commandes) en utilisant une commande de base puis la fonction <code><a href="https://dplyr.tidyverse.org/reference/slice.html">dplyr::slice()</a></code>. Afficher le résultat dans une <em>jolie</em> table grâce à la fonction <code>kable()</code>du package <code>knitr</code>.</p>
</section><section id="exercice-4-filtre" class="level4"><h4 class="anchored" data-anchor-id="exercice-4-filtre">Exercice 4 : Filtre</h4>
<ol type="1">
<li><p>Construire un sous-dataframe ne contenant que les individus fumeurs, en utilisant <code>[,]</code>, puis <code><a href="https://rdrr.io/r/base/subset.html">subset()</a></code>, et enfin <code><a href="https://dplyr.tidyverse.org/reference/filter.html">dplyr::filter()</a></code>.</p></li>
<li><p>Donner les identifiants (colonne <code>ID</code>) des individus des individus présentant de l’hypertension (variable <code>HT</code> valant 1).</p></li>
<li><p>Sélectionner le sous-dataframe ne contenant que les individus fumeurs et âgés de moins de 20 ans.</p></li>
<li><p>Donner les indices des individus ayant un poids inférieur à 110 (le poids de la mère est en livres) ou ayant un bébé de poids inférieur à 2,5 kg.</p></li>
</ol></section><section id="exercice-5-suppression-de-lignes-ou-de-colonnes" class="level4"><h4 class="anchored" data-anchor-id="exercice-5-suppression-de-lignes-ou-de-colonnes">Exercice 5 : Suppression de lignes ou de colonnes</h4>
<p>En essayant avec <code>[,]</code>, <code><a href="https://rdrr.io/r/base/subset.html">subset()</a></code> et les fonctions de <code>dplyr</code> :</p>
<ol type="1">
<li><p>Supprimer la première ligne du jeu de données.</p></li>
<li><p>Supprimer les colonnes “AGE”, “LWT”, “RACE”, “BWT”.</p></li>
</ol>
<p><em>Indice : utiliser la même syntaxe que pour la sélection mais avec le signe <code>-</code> pour indiquer les éléments à supprimer…</em></p>
</section><section id="exercice-6-ajout-de-lignes-ou-de-colonnes" class="level4"><h4 class="anchored" data-anchor-id="exercice-6-ajout-de-lignes-ou-de-colonnes">Exercice 6 : Ajout de lignes ou de colonnes</h4>
<p>Ajouter un une ligne (un individu) possédant les valeurs suivantes : <code>1, 20, 143, 2, "Non-Fumeur", 0, 0, 0, 0, 2500</code></p>
<p><strong>NB</strong>: On peut rajouter une colonne (une variable), à l’aide de <code>$</code>, <code><a href="https://rdrr.io/r/base/transform.html">transform()</a></code> ou <code><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate()</a></code> (comme vu précédemment).</p>
</section></section><section id="fusion" class="level3"><h3 class="anchored" data-anchor-id="fusion">Fusion</h3>
<p>La fonction <code><a href="https://rdrr.io/r/base/merge.html">merge()</a></code> permet de fusionner deux tableaux de données :</p>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">naissance</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>  ID AGE LWT RACE      SMOKE PTL HT UI FVT  BWT
1 85  19 182    2 Non-Fumeur   0  0  1   0 2523
2 86  33 155    3 Non-Fumeur   0  0  0   3 2551
3 87  20 105    1     Fumeur   0  0  0   1 2557
4 88  21 108    1     Fumeur   0  0  1   2 2594
5 89  18 107    1     Fumeur   0  0  1   0 2600
6 91  21 124    3 Non-Fumeur   0  0  0   0 2622</code></pre>
</div>
<details><summary>Code</summary><div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">nais1</span> <span class="op">&lt;-</span> <span class="va">naissance</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">nais1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>  ID AGE LWT RACE      SMOKE PTL
1 85  19 182    2 Non-Fumeur   0
2 86  33 155    3 Non-Fumeur   0
3 87  20 105    1     Fumeur   0
4 88  21 108    1     Fumeur   0
5 89  18 107    1     Fumeur   0
6 91  21 124    3 Non-Fumeur   0</code></pre>
</div>
<details><summary>Code</summary><div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">nais2</span> <span class="op">&lt;-</span> <span class="va">naissance</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">7</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">nais2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>  ID HT UI FVT  BWT
1 85  0  1   0 2523
2 86  0  0   3 2551
3 87  0  0   1 2557
4 88  0  1   2 2594
5 89  0  1   0 2600
6 91  0  0   0 2622</code></pre>
</div>
<details><summary>Code</summary><div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">nais_fus1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html">merge</a></span><span class="op">(</span><span class="va">nais1</span>, <span class="va">nais2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">nais_fus1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>  ID AGE LWT RACE      SMOKE PTL HT UI FVT  BWT
1  1  20 143    2 Non-Fumeur   0  0  0   0 2500
2  4  28 120    3     Fumeur   1  0  1   0  709
3 10  29 130    1 Non-Fumeur   0  0  1   2 1021
4 11  34 187    2     Fumeur   0  1  0   0 1135
5 13  25 105    3 Non-Fumeur   1  1  0   0 1330
6 15  25  85    3 Non-Fumeur   0  0  1   0 1474</code></pre>
</div>
<details><summary>Code</summary><div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Ici, vu que les individus sont dans le même ordre on aurait pu utiliser la</span></span>
<span><span class="co"># fonction cbind(), et la colonne ID n'est pas utile :</span></span>
<span><span class="va">nais_fus2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">nais1</span>, <span class="va">nais2</span><span class="op">[</span>, <span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">nais_fus2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>  ID AGE LWT RACE      SMOKE PTL HT UI FVT  BWT
1 85  19 182    2 Non-Fumeur   0  0  1   0 2523
2 86  33 155    3 Non-Fumeur   0  0  0   3 2551
3 87  20 105    1     Fumeur   0  0  0   1 2557
4 88  21 108    1     Fumeur   0  0  1   2 2594
5 89  18 107    1     Fumeur   0  0  1   0 2600
6 91  21 124    3 Non-Fumeur   0  0  0   0 2622</code></pre>
</div>
<details><summary>Code</summary><div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/identical.html">identical</a></span><span class="op">(</span><span class="va">nais_fus1</span>, <span class="va">nais_fus2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE</code></pre>
</div>
<details><summary>Code</summary><div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Les deux dataframes ne sont pas identitiques, car merge a classé par ordre</span></span>
<span><span class="co"># croissant suivant la variable de regroupement ID, mais les informations sont</span></span>
<span><span class="co"># les mêmes.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>On peut également fusionner deux tableaux de données où les individus (qui doivent être les mêmes) ne sont pas dans le même ordre :</p>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">desordre</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">naissance</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">naissance</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">nais3</span> <span class="op">&lt;-</span> <span class="va">naissance</span><span class="op">[</span><span class="va">desordre</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">7</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">nais3</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>     ID HT UI FVT  BWT
74  166  0  0   0 3374
134  13  1  0   0 1330
19  104  0  1   0 2807
97  191  0  0   1 3651
172  60  0  0   0 2381
176  65  0  0   0 2410</code></pre>
</div>
<details><summary>Code</summary><div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">nais_fus3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html">merge</a></span><span class="op">(</span><span class="va">nais1</span>, <span class="va">nais3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">nais_fus3</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>  ID AGE LWT RACE      SMOKE PTL HT UI FVT  BWT
1  1  20 143    2 Non-Fumeur   0  0  0   0 2500
2  4  28 120    3     Fumeur   1  0  1   0  709
3 10  29 130    1 Non-Fumeur   0  0  1   2 1021
4 11  34 187    2     Fumeur   0  1  0   0 1135
5 13  25 105    3 Non-Fumeur   1  1  0   0 1330
6 15  25  85    3 Non-Fumeur   0  0  1   0 1474</code></pre>
</div>
<details><summary>Code</summary><div class="sourceCode" id="cb30"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/identical.html">identical</a></span><span class="op">(</span><span class="va">nais_fus1</span>, <span class="va">nais_fus3</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
</div>
<section id="exercice-7-join" class="level4"><h4 class="anchored" data-anchor-id="exercice-7-join">Exercice 7 : join</h4>
<ol type="1">
<li><p>Consulter l’aide de <code><a href="https://dplyr.tidyverse.org/reference/sample_n.html">dplyr::sample_n</a></code> et trouver un moyens simple de permuter les lignes du jeu de données.</p></li>
<li><p>Consulter l’aide de <code><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">dplyr::join()</a></code> (pour plus d’informations sur les fusions avec <code>dplyr</code> consulter cette <a href="https://cran.rstudio.com/web/packages/dplyr/vignettes/two-table.html">page</a>), puis utiliser la fonction <code><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">dplyr::left_join()</a></code> pour fusionner les tables <code>nais1</code> et <code>nais3</code>.</p></li>
</ol></section></section><section id="trier-un-tableau-de-données-le-long-dune-colonne" class="level3"><h3 class="anchored" data-anchor-id="trier-un-tableau-de-données-le-long-dune-colonne">Trier un tableau de données le long d’une colonne</h3>
<p>Pour trier le tableau suivant la variable <code>ID</code> par ordre croissant, on utilise la fonction <code><a href="https://rdrr.io/r/base/order.html">order()</a></code> :</p>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb32"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">nais_orderID</span> <span class="op">&lt;-</span> <span class="va">naissance</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html">order</a></span><span class="op">(</span><span class="va">naissance</span><span class="op">$</span><span class="va">ID</span><span class="op">)</span>, <span class="op">]</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">nais_orderID</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">ID</th>
<th style="text-align: right;">AGE</th>
<th style="text-align: right;">LWT</th>
<th style="text-align: right;">RACE</th>
<th style="text-align: left;">SMOKE</th>
<th style="text-align: right;">PTL</th>
<th style="text-align: right;">HT</th>
<th style="text-align: right;">UI</th>
<th style="text-align: right;">FVT</th>
<th style="text-align: right;">BWT</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">190</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">20</td>
<td style="text-align: right;">143</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">Non-Fumeur</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2500</td>
</tr>
<tr class="even">
<td style="text-align: left;">131</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">28</td>
<td style="text-align: right;">120</td>
<td style="text-align: right;">3</td>
<td style="text-align: left;">Fumeur</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">709</td>
</tr>
<tr class="odd">
<td style="text-align: left;">132</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">29</td>
<td style="text-align: right;">130</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">Non-Fumeur</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1021</td>
</tr>
<tr class="even">
<td style="text-align: left;">133</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">34</td>
<td style="text-align: right;">187</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">Fumeur</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1135</td>
</tr>
<tr class="odd">
<td style="text-align: left;">134</td>
<td style="text-align: right;">13</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">105</td>
<td style="text-align: right;">3</td>
<td style="text-align: left;">Non-Fumeur</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1330</td>
</tr>
<tr class="even">
<td style="text-align: left;">135</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">85</td>
<td style="text-align: right;">3</td>
<td style="text-align: left;">Non-Fumeur</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1474</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Maintenant, si on veut trier le tableau suivant l’âge par ordre décroissant :</p>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb33"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">nais_decAGE</span> <span class="op">&lt;-</span> <span class="va">naissance</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html">order</a></span><span class="op">(</span><span class="va">naissance</span><span class="op">$</span><span class="va">AGE</span>, decreasing <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, <span class="op">]</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="va">nais_decAGE</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="op">]</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">ID</th>
<th style="text-align: right;">AGE</th>
<th style="text-align: right;">LWT</th>
<th style="text-align: right;">RACE</th>
<th style="text-align: left;">SMOKE</th>
<th style="text-align: right;">PTL</th>
<th style="text-align: right;">HT</th>
<th style="text-align: right;">UI</th>
<th style="text-align: right;">FVT</th>
<th style="text-align: right;">BWT</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">130</td>
<td style="text-align: right;">226</td>
<td style="text-align: right;">45</td>
<td style="text-align: right;">123</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">Non-Fumeur</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4990</td>
</tr>
<tr class="even">
<td style="text-align: left;">23</td>
<td style="text-align: right;">108</td>
<td style="text-align: right;">36</td>
<td style="text-align: right;">202</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">Non-Fumeur</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2836</td>
</tr>
<tr class="odd">
<td style="text-align: left;">89</td>
<td style="text-align: right;">183</td>
<td style="text-align: right;">36</td>
<td style="text-align: right;">175</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">Non-Fumeur</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3600</td>
</tr>
<tr class="even">
<td style="text-align: left;">33</td>
<td style="text-align: right;">119</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">121</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">Fumeur</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2948</td>
</tr>
<tr class="odd">
<td style="text-align: left;">127</td>
<td style="text-align: right;">223</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">170</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">Non-Fumeur</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4174</td>
</tr>
<tr class="even">
<td style="text-align: left;">133</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">34</td>
<td style="text-align: right;">187</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">Fumeur</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1135</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2</td>
<td style="text-align: right;">86</td>
<td style="text-align: right;">33</td>
<td style="text-align: right;">155</td>
<td style="text-align: right;">3</td>
<td style="text-align: left;">Non-Fumeur</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">2551</td>
</tr>
<tr class="even">
<td style="text-align: left;">40</td>
<td style="text-align: right;">127</td>
<td style="text-align: right;">33</td>
<td style="text-align: right;">109</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">Fumeur</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3033</td>
</tr>
<tr class="odd">
<td style="text-align: left;">114</td>
<td style="text-align: right;">210</td>
<td style="text-align: right;">33</td>
<td style="text-align: right;">117</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">Non-Fumeur</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3912</td>
</tr>
<tr class="even">
<td style="text-align: left;">21</td>
<td style="text-align: right;">106</td>
<td style="text-align: right;">32</td>
<td style="text-align: right;">121</td>
<td style="text-align: right;">3</td>
<td style="text-align: left;">Non-Fumeur</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2835</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>On remarque qu’il y a des ex-aequo. On peut rajouter une variable sur laquelle trier les ex-aequo, en deuxième argument de <code><a href="https://rdrr.io/r/base/order.html">order()</a></code> :</p>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb34"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">nais_decAGE_decLWT</span> <span class="op">&lt;-</span> <span class="va">naissance</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html">order</a></span><span class="op">(</span><span class="va">naissance</span><span class="op">$</span><span class="va">AGE</span>, <span class="va">naissance</span><span class="op">$</span><span class="va">LWT</span>, decreasing <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    <span class="op">]</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="va">nais_decAGE_decLWT</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="op">]</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">ID</th>
<th style="text-align: right;">AGE</th>
<th style="text-align: right;">LWT</th>
<th style="text-align: right;">RACE</th>
<th style="text-align: left;">SMOKE</th>
<th style="text-align: right;">PTL</th>
<th style="text-align: right;">HT</th>
<th style="text-align: right;">UI</th>
<th style="text-align: right;">FVT</th>
<th style="text-align: right;">BWT</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">130</td>
<td style="text-align: right;">226</td>
<td style="text-align: right;">45</td>
<td style="text-align: right;">123</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">Non-Fumeur</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4990</td>
</tr>
<tr class="even">
<td style="text-align: left;">23</td>
<td style="text-align: right;">108</td>
<td style="text-align: right;">36</td>
<td style="text-align: right;">202</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">Non-Fumeur</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2836</td>
</tr>
<tr class="odd">
<td style="text-align: left;">89</td>
<td style="text-align: right;">183</td>
<td style="text-align: right;">36</td>
<td style="text-align: right;">175</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">Non-Fumeur</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3600</td>
</tr>
<tr class="even">
<td style="text-align: left;">127</td>
<td style="text-align: right;">223</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">170</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">Non-Fumeur</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4174</td>
</tr>
<tr class="odd">
<td style="text-align: left;">33</td>
<td style="text-align: right;">119</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">121</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">Fumeur</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2948</td>
</tr>
<tr class="even">
<td style="text-align: left;">133</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">34</td>
<td style="text-align: right;">187</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">Fumeur</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1135</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2</td>
<td style="text-align: right;">86</td>
<td style="text-align: right;">33</td>
<td style="text-align: right;">155</td>
<td style="text-align: right;">3</td>
<td style="text-align: left;">Non-Fumeur</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">2551</td>
</tr>
<tr class="even">
<td style="text-align: left;">114</td>
<td style="text-align: right;">210</td>
<td style="text-align: right;">33</td>
<td style="text-align: right;">117</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">Non-Fumeur</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3912</td>
</tr>
<tr class="odd">
<td style="text-align: left;">40</td>
<td style="text-align: right;">127</td>
<td style="text-align: right;">33</td>
<td style="text-align: right;">109</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">Fumeur</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3033</td>
</tr>
<tr class="even">
<td style="text-align: left;">111</td>
<td style="text-align: right;">207</td>
<td style="text-align: right;">32</td>
<td style="text-align: right;">186</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">Non-Fumeur</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">3860</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Enfin, si on veut que le classement soit fait de façon croissante sur <code>LWT</code>, on peut procéder de la façon suivante :</p>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb35"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">nais_decAGE_LWT</span> <span class="op">&lt;-</span> <span class="va">naissance</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html">order</a></span><span class="op">(</span><span class="va">naissance</span><span class="op">$</span><span class="va">AGE</span>, <span class="op">-</span><span class="va">naissance</span><span class="op">$</span><span class="va">LWT</span>, decreasing <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    <span class="op">]</span></span>
<span><span class="va">nais_decAGE_LWT</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>     ID AGE LWT RACE      SMOKE PTL HT UI FVT  BWT
130 226  45 123    1 Non-Fumeur   0  0  0   1 4990
89  183  36 175    1 Non-Fumeur   0  0  0   0 3600
23  108  36 202    1 Non-Fumeur   0  0  0   1 2836
33  119  35 121    2     Fumeur   1  0  0   1 2948
127 223  35 170    1 Non-Fumeur   1  0  0   1 4174
133  11  34 187    2     Fumeur   0  1  0   0 1135
40  127  33 109    1     Fumeur   0  0  0   1 3033
114 210  33 117    1 Non-Fumeur   0  0  1   1 3912
2    86  33 155    3 Non-Fumeur   0  0  0   3 2551
141  22  32 105    1     Fumeur   0  0  0   0 1818</code></pre>
</div>
</div>
<section id="exercice-8-dplyrarrange" class="level4"><h4 class="anchored" data-anchor-id="exercice-8-dplyrarrange">Exercice 8 : <code>dplyr::arrange()</code>
</h4>
<ol type="1">
<li><p>Utiliser la fonction <code><a href="https://dplyr.tidyverse.org/reference/arrange.html">dplyr::arrange()</a></code> pour reproduire les tris précédents.</p></li>
<li><p>Trier le dataframe suivant la variable <code>SMOKE</code> (qui est un facteur). Comment R choisit-il pour déterminer quelle modalité du facteur va apparaître en premier ?</p></li>
<li><p>Rajouter une variable, nommée <code>lettre</code> au dataframe, contenant des lettres majuscules choisies alétoirement. On peut utiliser <code>sample(letters, nrow(naissance), replace = TRUE)</code> pour générer ce tirage aléatoire.</p></li>
<li><p>Trier le dataframe suivant la nouvelle variable <code>lettre</code>.</p></li>
</ol></section></section><section id="la-classe-tlb" class="level3"><h3 class="anchored" data-anchor-id="la-classe-tlb">La classe <code>tlb</code>
</h3>
<p>Le package s’appuie sur une nouvelle classe d’objets : <code>tbl</code>. Le résultat affiché lorsqu’on tape le nom du tableau est tronqué pour cette nouvelle classe :</p>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb37"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">nais</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html">as_tibble</a></span><span class="op">(</span><span class="va">naissance</span><span class="op">)</span></span>
<span><span class="va">nais</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code># A tibble: 190 × 10
      ID   AGE   LWT  RACE SMOKE        PTL    HT    UI   FVT   BWT
   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;fct&gt;      &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1    85    19   182     2 Non-Fumeur     0     0     1     0  2523
 2    86    33   155     3 Non-Fumeur     0     0     0     3  2551
 3    87    20   105     1 Fumeur         0     0     0     1  2557
 4    88    21   108     1 Fumeur         0     0     1     2  2594
 5    89    18   107     1 Fumeur         0     0     1     0  2600
 6    91    21   124     3 Non-Fumeur     0     0     0     0  2622
 7    92    22   118     1 Non-Fumeur     0     0     0     1  2637
 8    93    17   103     3 Non-Fumeur     0     0     0     1  2637
 9    94    29   123     1 Fumeur         0     0     0     1  2663
10    95    26   113     1 Fumeur         0     0     0     0  2665
# ℹ 180 more rows</code></pre>
</div>
<details><summary>Code</summary><div class="sourceCode" id="cb39"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/class.html">class</a></span><span class="op">(</span><span class="va">nais</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>[1] "tbl_df"     "tbl"        "data.frame"</code></pre>
</div>
</div>
<p>De plus, le comportement de la sélection de colonne est changé : on garde la structure de tableau de données même lorsqu’on sélectionne une seule colonne :</p>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb41"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">naissance</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code> num [1:190] 19 33 20 21 18 21 22 17 29 26 ...</code></pre>
</div>
<details><summary>Code</summary><div class="sourceCode" id="cb43"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">nais</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output cell-output-stdout">
<pre><code>tibble [190 × 1] (S3: tbl_df/tbl/data.frame)
 $ AGE: num [1:190] 19 33 20 21 18 21 22 17 29 26 ...</code></pre>
</div>
</div>
<section id="exercice-9-dplyrarrange" class="level4"><h4 class="anchored" data-anchor-id="exercice-9-dplyrarrange">Exercice 9 : <code>dplyr::arrange()</code>
</h4>
<ol type="1">
<li>Utiliser la fonction<code><a href="https://dplyr.tidyverse.org/reference/arrange.html">dplyr::arrange()</a></code> pour ordonner le tableau de données naissance par age, avec les poids de naissance par ordre décroissant pour les égalités.</li>
</ol></section></section></section></section><section id="introduction-au-pipe" class="level1"><h1>Introduction au pipe <code>%&gt;%</code>
</h1>
<section id="exercice-10" class="level4"><h4 class="anchored" data-anchor-id="exercice-10">Exercice 10</h4>
<ol type="1">
<li><p>À l’aide des fonctions <code><a href="https://dplyr.tidyverse.org/reference/group_by.html">dplyr::group_by()</a></code>, <code><a href="https://dplyr.tidyverse.org/reference/summarise.html">dplyr::summarize()</a></code>, <code><a href="https://dplyr.tidyverse.org/reference/context.html">dplyr::n()</a></code>, <code><a href="https://dplyr.tidyverse.org/reference/filter.html">dplyr::filter()</a></code> et <code><a href="https://dplyr.tidyverse.org/reference/arrange.html">dplyr::arrange()</a></code>, construire le tableau de données donnant le poids moyen à la naissance par âge stratifié sur le statut tabagique, ainsi que le nombre d’observations correpondantes, et ordonné le résultat par ordre de poids moyen croissant en ne sélectionnant que les catéories pour lesquelles le poids moyen est inférieur à 2,5kg.</p></li>
<li><p>Réécrire le code de la réponse précédente à l’aide de l’opérateur <code>%&gt;%</code></p></li>
</ol></section></section><section id="résumé" class="level1"><h1>Résumé</h1>
<p>Le package <code>dplyr</code> propose un ensemble de fonctions très simples à utiliser et permettant de réaliser toutes les opérations classiques sur les tableaux de données, avec une syntaxe très claire et compréhensible.</p>
<p>Pour aller plus loin, ou voir d’autres exemples, consulter cette <a href="https://cran.rstudio.com/web/packages/dplyr/vignettes/dplyr.html">page</a>. On renverra également vers cet <a href="https://www.rstudio.com/wp-content/uploads/2016/01/data-wrangling-french.pdf">aide-mémoire</a>.</p>
<p>En dehors du changement de syntaxe, les gains en temps de calcul sont souvent significatifs avec <code>dplyr</code>. Il existe un autre package populaire pour faire des manipulations sur les (grands) jeux de données : <code>data.table</code>. La syntaxe est un peu moins intuitive que <code>dplyr</code>, mais l’efficacité est encore accrue.</p>
<!-- -->

</section></main><!-- /main column --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb45" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "SAVOR: Part III"</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="an">subtitle:</span><span class="co"> "`dplyr` and `%&gt;%`"</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Robin Genuer &amp; Boris Hejblum"</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> "06/06/2024"</span></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a><span class="an">highlight-style:</span><span class="co"> pygments</span></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span><span class="co"> </span></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: true</span></span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a><span class="co">    code-link: true</span></span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a><span class="co">    tidy: true</span></span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a><span class="co">    embed-resources: true</span></span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a><span class="an">editor:</span><span class="co"> source</span></span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-20"><a href="#cb45-20" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb45-21"><a href="#cb45-21" aria-hidden="true" tabindex="-1"></a><span class="co">#| include: false</span></span>
<span id="cb45-22"><a href="#cb45-22" aria-hidden="true" tabindex="-1"></a>correction <span class="ot">&lt;-</span> <span class="cn">FALSE</span></span>
<span id="cb45-23"><a href="#cb45-23" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">tidy =</span> <span class="cn">TRUE</span>, <span class="at">message =</span> <span class="cn">FALSE</span>, <span class="at">include =</span> correction)</span>
<span id="cb45-24"><a href="#cb45-24" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-25"><a href="#cb45-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-26"><a href="#cb45-26" aria-hidden="true" tabindex="-1"></a><span class="fu"># Objectifs</span></span>
<span id="cb45-27"><a href="#cb45-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-28"><a href="#cb45-28" aria-hidden="true" tabindex="-1"></a>Ce document donne tout d'abord quelques considérations sur l'importation de</span>
<span id="cb45-29"><a href="#cb45-29" aria-hidden="true" tabindex="-1"></a>données et sur les strucutres de bases de R, avant de donner quelques éléments</span>
<span id="cb45-30"><a href="#cb45-30" aria-hidden="true" tabindex="-1"></a>introductifs sur l'utilisation du package <span class="in">`dplyr`</span>.</span>
<span id="cb45-31"><a href="#cb45-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-32"><a href="#cb45-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-33"><a href="#cb45-33" aria-hidden="true" tabindex="-1"></a><span class="fu"># Introduction à `dplyr`</span></span>
<span id="cb45-34"><a href="#cb45-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-35"><a href="#cb45-35" aria-hidden="true" tabindex="-1"></a>Il existe un très grand nombre de packages additionnels dans <span class="in">`r fontawesome::fa('r-project')`</span>. Certains</span>
<span id="cb45-36"><a href="#cb45-36" aria-hidden="true" tabindex="-1"></a>apportent de nouvelles fonctionnalités (méthodes statistiques qui n'étaient pas</span>
<span id="cb45-37"><a href="#cb45-37" aria-hidden="true" tabindex="-1"></a>disponible auparavant), et d'autres apportent des améliorations à des</span>
<span id="cb45-38"><a href="#cb45-38" aria-hidden="true" tabindex="-1"></a>fonctionnalités déjà présentes dans <span class="in">`r fontawesome::fa('r-project')`</span>.</span>
<span id="cb45-39"><a href="#cb45-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-40"><a href="#cb45-40" aria-hidden="true" tabindex="-1"></a>Le package <span class="in">`dplyr`</span> rentre essentiellement dans la 2^ème^ catégorie. Il propose</span>
<span id="cb45-41"><a href="#cb45-41" aria-hidden="true" tabindex="-1"></a>de re-définir la manipulation de données dans R, avec une syntaxe plus simple,</span>
<span id="cb45-42"><a href="#cb45-42" aria-hidden="true" tabindex="-1"></a>tout en améliorant les performances lorsqu'on gère des grands tableaux de</span>
<span id="cb45-43"><a href="#cb45-43" aria-hidden="true" tabindex="-1"></a>données.</span>
<span id="cb45-44"><a href="#cb45-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-45"><a href="#cb45-45" aria-hidden="true" tabindex="-1"></a>Installer le package <span class="in">`dplyr`</span> puis le charger :</span>
<span id="cb45-46"><a href="#cb45-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-47"><a href="#cb45-47" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, include=TRUE}</span></span>
<span id="cb45-48"><a href="#cb45-48" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages("dplyr")</span></span>
<span id="cb45-49"><a href="#cb45-49" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb45-50"><a href="#cb45-50" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-51"><a href="#cb45-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-52"><a href="#cb45-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-53"><a href="#cb45-53" aria-hidden="true" tabindex="-1"></a><span class="fu">## Gestion de fichiers de données</span></span>
<span id="cb45-54"><a href="#cb45-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-55"><a href="#cb45-55" aria-hidden="true" tabindex="-1"></a>Avant de se lancer dans l'utilisation de <span class="in">`dplyr`</span>, nous allons revoir quelques</span>
<span id="cb45-56"><a href="#cb45-56" aria-hidden="true" tabindex="-1"></a>principes dans la gestion des fichiers de données sous <span class="in">`r fontawesome::fa('r-project')`</span>.</span>
<span id="cb45-57"><a href="#cb45-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-58"><a href="#cb45-58" aria-hidden="true" tabindex="-1"></a><span class="fu">### Importation</span></span>
<span id="cb45-59"><a href="#cb45-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-60"><a href="#cb45-60" aria-hidden="true" tabindex="-1"></a>Le plus simple pour importer des données est d'utiliser l'outil graphique de</span>
<span id="cb45-61"><a href="#cb45-61" aria-hidden="true" tabindex="-1"></a>Rstudio "Import Dataset", présent dans l'onglet "Environnement" ou dans le</span>
<span id="cb45-62"><a href="#cb45-62" aria-hidden="true" tabindex="-1"></a>menu "File".</span>
<span id="cb45-63"><a href="#cb45-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-64"><a href="#cb45-64" aria-hidden="true" tabindex="-1"></a>Sinon, on peut bien entendu utiliser la fonction <span class="in">`read.table()`</span> et ses dérivées</span>
<span id="cb45-65"><a href="#cb45-65" aria-hidden="true" tabindex="-1"></a>(<span class="in">`read.csv()`</span>, <span class="in">`read.delim()`</span>...).</span>
<span id="cb45-66"><a href="#cb45-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-67"><a href="#cb45-67" aria-hidden="true" tabindex="-1"></a>Importer le fichier <span class="in">`naissance.txt`</span>, puis regarder la structure du tableau créé</span>
<span id="cb45-68"><a href="#cb45-68" aria-hidden="true" tabindex="-1"></a>via la fonction <span class="in">`str()`</span>.</span>
<span id="cb45-69"><a href="#cb45-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-70"><a href="#cb45-70" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, include=correction}</span></span>
<span id="cb45-71"><a href="#cb45-71" aria-hidden="true" tabindex="-1"></a>naissance <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="st">"naissance.txt"</span>)</span>
<span id="cb45-72"><a href="#cb45-72" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(naissance)</span>
<span id="cb45-73"><a href="#cb45-73" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-74"><a href="#cb45-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-75"><a href="#cb45-75" aria-hidden="true" tabindex="-1"></a><span class="in">`r fontawesome::fa('r-project')`</span> considère toutes les variables comme des suite de nombres</span>
<span id="cb45-76"><a href="#cb45-76" aria-hidden="true" tabindex="-1"></a>entiers (car effectivement il n'y a pas de nombres à virgule), ce qui est</span>
<span id="cb45-77"><a href="#cb45-77" aria-hidden="true" tabindex="-1"></a>correcte pour les variables quantitatives (comme l'âge ou encore le poids de</span>
<span id="cb45-78"><a href="#cb45-78" aria-hidden="true" tabindex="-1"></a>l'enfant <span class="in">`BWT`</span>). Par contre, certaines variables sont qualitatives (comme</span>
<span id="cb45-79"><a href="#cb45-79" aria-hidden="true" tabindex="-1"></a><span class="in">`SMOKE`</span>), donc si on veut des facteurs, il faut le forcer.</span>
<span id="cb45-80"><a href="#cb45-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-81"><a href="#cb45-81" aria-hidden="true" tabindex="-1"></a>Transformer la variable <span class="in">`SMOKE`</span> en facteur, et renommer les niveaux en "Non-Fumeur" (0 dans le fichier txt) et "Fumeur" (1 dans le fichier txt).</span>
<span id="cb45-82"><a href="#cb45-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-83"><a href="#cb45-83" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=correction}</span></span>
<span id="cb45-84"><a href="#cb45-84" aria-hidden="true" tabindex="-1"></a>naissance<span class="sc">$</span>SMOKE <span class="ot">&lt;-</span> <span class="fu">factor</span>(naissance<span class="sc">$</span>SMOKE, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Non-Fumeur"</span>, <span class="st">"Fumeur"</span>))</span>
<span id="cb45-85"><a href="#cb45-85" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(naissance)</span>
<span id="cb45-86"><a href="#cb45-86" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-87"><a href="#cb45-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-88"><a href="#cb45-88" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Exercice 0 :</span></span>
<span id="cb45-89"><a href="#cb45-89" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb45-90"><a href="#cb45-90" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Charger le fichier de données nommé <span class="in">`naissance_na.txt`</span>.</span>
<span id="cb45-91"><a href="#cb45-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-94"><a href="#cb45-94" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb45-95"><a href="#cb45-95" aria-hidden="true" tabindex="-1"></a>naissance_na <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">"naissance_na.txt"</span>, <span class="at">sep=</span><span class="st">";"</span>)</span>
<span id="cb45-96"><a href="#cb45-96" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-97"><a href="#cb45-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-98"><a href="#cb45-98" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Consulter la structure de l'objet créé (par exemple nommé <span class="in">`naissance_na`</span>).</span>
<span id="cb45-99"><a href="#cb45-99" aria-hidden="true" tabindex="-1"></a>Que remarquez-vous pour la variable <span class="in">`LWT`</span> ?</span>
<span id="cb45-100"><a href="#cb45-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-101"><a href="#cb45-101" aria-hidden="true" tabindex="-1"></a><span class="in">```{r strNA}</span></span>
<span id="cb45-102"><a href="#cb45-102" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(naissance_na)</span>
<span id="cb45-103"><a href="#cb45-103" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-104"><a href="#cb45-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-105"><a href="#cb45-105" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>Pour régler le problème, modifier le contenu de la case "NA.strings" lors</span>
<span id="cb45-106"><a href="#cb45-106" aria-hidden="true" tabindex="-1"></a>du chargement du fichier de données avec "Import Dataset" (ou modifier le paramètre <span class="in">`na.strings`</span> de la fonction <span class="in">`read.table()`</span> ou de ses dérivées). Puis vérifier la nouvelle structure de l'objet.</span>
<span id="cb45-107"><a href="#cb45-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-108"><a href="#cb45-108" aria-hidden="true" tabindex="-1"></a><span class="in">```{r importNA}</span></span>
<span id="cb45-109"><a href="#cb45-109" aria-hidden="true" tabindex="-1"></a>naissance_na <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">"naissance_na.txt"</span>, <span class="at">sep=</span><span class="st">";"</span>, <span class="at">na.strings =</span> <span class="st">"."</span>)</span>
<span id="cb45-110"><a href="#cb45-110" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(naissance_na)</span>
<span id="cb45-111"><a href="#cb45-111" aria-hidden="true" tabindex="-1"></a><span class="in">```</span> </span>
<span id="cb45-112"><a href="#cb45-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-113"><a href="#cb45-113" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>A l'aide de la fonction <span class="in">`transform()`</span>, transformer en facteur les variables <span class="in">`RACE`</span> (1=blanche, 2=noire, 3=autres), <span class="in">`HT`</span> (0=non, 1=oui) et <span class="in">`UI`</span> (0=non, 1=oui) en une seule commande.</span>
<span id="cb45-114"><a href="#cb45-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-115"><a href="#cb45-115" aria-hidden="true" tabindex="-1"></a><span class="in">```{r transformNA, tidy=FALSE}</span></span>
<span id="cb45-116"><a href="#cb45-116" aria-hidden="true" tabindex="-1"></a>naissance_na <span class="ot">&lt;-</span> <span class="fu">transform</span>(naissance_na,</span>
<span id="cb45-117"><a href="#cb45-117" aria-hidden="true" tabindex="-1"></a>    <span class="at">RACE =</span> <span class="fu">factor</span>(RACE, <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"blanche"</span>, <span class="st">"noire"</span>, <span class="st">"autres"</span>)),</span>
<span id="cb45-118"><a href="#cb45-118" aria-hidden="true" tabindex="-1"></a>    <span class="at">HT =</span> <span class="fu">factor</span>(HT, <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"non"</span>, <span class="st">"oui"</span>)),</span>
<span id="cb45-119"><a href="#cb45-119" aria-hidden="true" tabindex="-1"></a>    <span class="at">UI =</span> <span class="fu">factor</span>(UI, <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"non"</span>, <span class="st">"oui"</span>)))</span>
<span id="cb45-120"><a href="#cb45-120" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(naissance_na)</span>
<span id="cb45-121"><a href="#cb45-121" aria-hidden="true" tabindex="-1"></a><span class="in">```</span> </span>
<span id="cb45-122"><a href="#cb45-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-123"><a href="#cb45-123" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>Toujours à l'aide de la fonction <span class="in">`transform()`</span>, créer deux nouvelles variables (utiliser deux commandes différentes, puis essayer en une seule fois) :</span>
<span id="cb45-124"><a href="#cb45-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-125"><a href="#cb45-125" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span><span class="in">`POIDS`</span>, contenant le poids de la mère en g (1 livre = 453 g).</span>
<span id="cb45-126"><a href="#cb45-126" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb45-127"><a href="#cb45-127" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span><span class="in">`RAPPORT`</span>, contenant le rapport entre le poids de l'enfant et celui de la</span>
<span id="cb45-128"><a href="#cb45-128" aria-hidden="true" tabindex="-1"></a>       mère (en grammes tous les deux).</span>
<span id="cb45-129"><a href="#cb45-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-130"><a href="#cb45-130" aria-hidden="true" tabindex="-1"></a><span class="in">```{r transformNA2, error=TRUE, eval=correction}</span></span>
<span id="cb45-131"><a href="#cb45-131" aria-hidden="true" tabindex="-1"></a>naissance_na <span class="ot">&lt;-</span> <span class="fu">transform</span>(naissance_na, <span class="at">POIDS =</span> LWT <span class="sc">*</span> <span class="dv">453</span>, <span class="at">RAPPORT =</span> BWT<span class="sc">/</span>POIDS)</span>
<span id="cb45-132"><a href="#cb45-132" aria-hidden="true" tabindex="-1"></a>naissance_na <span class="ot">&lt;-</span> <span class="fu">transform</span>(naissance_na, <span class="at">POIDS =</span> LWT <span class="sc">*</span> <span class="dv">453</span>)</span>
<span id="cb45-133"><a href="#cb45-133" aria-hidden="true" tabindex="-1"></a>naissance_na <span class="ot">&lt;-</span> <span class="fu">transform</span>(naissance_na, <span class="at">RAPPORT =</span> BWT<span class="sc">/</span>POIDS)</span>
<span id="cb45-134"><a href="#cb45-134" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(naissance_na)</span>
<span id="cb45-135"><a href="#cb45-135" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-136"><a href="#cb45-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-137"><a href="#cb45-137" aria-hidden="true" tabindex="-1"></a><span class="ss">6. </span>Utiliser la fonction <span class="in">`dplyr::mutate()`</span> (du package <span class="in">`dplyr`</span>) pour répondre à la question précédente en une seule commande.</span>
<span id="cb45-138"><a href="#cb45-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-139"><a href="#cb45-139" aria-hidden="true" tabindex="-1"></a><span class="in">```{r mutateNA}</span></span>
<span id="cb45-140"><a href="#cb45-140" aria-hidden="true" tabindex="-1"></a>naissance_na <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">mutate</span>(naissance_na, <span class="at">POIDS2 =</span> LWT <span class="sc">*</span> <span class="dv">453</span>, <span class="at">RAPPORT2 =</span> BWT<span class="sc">/</span>POIDS2)</span>
<span id="cb45-141"><a href="#cb45-141" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(naissance_na)</span>
<span id="cb45-142"><a href="#cb45-142" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-143"><a href="#cb45-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-144"><a href="#cb45-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-145"><a href="#cb45-145" aria-hidden="true" tabindex="-1"></a><span class="fu">### Exportation</span></span>
<span id="cb45-146"><a href="#cb45-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-147"><a href="#cb45-147" aria-hidden="true" tabindex="-1"></a>Pour écrire une table de données, on utilise la fonction <span class="in">`write.table()`</span> ou ses dérivées.</span>
<span id="cb45-148"><a href="#cb45-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-149"><a href="#cb45-149" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, include=TRUE}</span></span>
<span id="cb45-150"><a href="#cb45-150" aria-hidden="true" tabindex="-1"></a>mon_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="st">"Partie"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Intro"</span>, <span class="st">"Bases"</span>, <span class="st">"Manip"</span>), <span class="st">"Temps"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">1.5</span>, <span class="fl">1.5</span>))</span>
<span id="cb45-151"><a href="#cb45-151" aria-hidden="true" tabindex="-1"></a>mon_df</span>
<span id="cb45-152"><a href="#cb45-152" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(mon_df, <span class="at">file =</span> <span class="st">"mon_df.csv"</span>)</span>
<span id="cb45-153"><a href="#cb45-153" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-154"><a href="#cb45-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-155"><a href="#cb45-155" aria-hidden="true" tabindex="-1"></a><span class="fu">### Sauvegarde</span></span>
<span id="cb45-156"><a href="#cb45-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-157"><a href="#cb45-157" aria-hidden="true" tabindex="-1"></a>On peut aussi sauvegarder une table au format <span class="in">`Rdata`</span> (qui est un format propre à R). Pour cela on utilise <span class="in">`save()`</span> :</span>
<span id="cb45-158"><a href="#cb45-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-159"><a href="#cb45-159" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, include=TRUE}</span></span>
<span id="cb45-160"><a href="#cb45-160" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(naissance, <span class="at">file =</span> <span class="st">"naissance.Rdata"</span>)</span>
<span id="cb45-161"><a href="#cb45-161" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-162"><a href="#cb45-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-163"><a href="#cb45-163" aria-hidden="true" tabindex="-1"></a>L'avantage est que lorsqu'on recharge le fichier avec la fonction <span class="in">`load()`</span>, il garde la bonne structure :</span>
<span id="cb45-164"><a href="#cb45-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-165"><a href="#cb45-165" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, include=TRUE}</span></span>
<span id="cb45-166"><a href="#cb45-166" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(naissance)</span>
<span id="cb45-167"><a href="#cb45-167" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"naissance.Rdata"</span>)</span>
<span id="cb45-168"><a href="#cb45-168" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(naissance)</span>
<span id="cb45-169"><a href="#cb45-169" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-170"><a href="#cb45-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-171"><a href="#cb45-171" aria-hidden="true" tabindex="-1"></a>On remarque qu'on a pas besoin d'affecter le résultat de <span class="in">`load()`</span> à un objet.</span>
<span id="cb45-172"><a href="#cb45-172" aria-hidden="true" tabindex="-1"></a>Ceci est dû au fait, qu'on peut sauvegarder plusieurs objets de la session</span>
<span id="cb45-173"><a href="#cb45-173" aria-hidden="true" tabindex="-1"></a>dans un même fichier <span class="in">`.Rdata`</span>. Et on pourra tous les recharger ensuite :</span>
<span id="cb45-174"><a href="#cb45-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-175"><a href="#cb45-175" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, include=TRUE, error=TRUE}</span></span>
<span id="cb45-176"><a href="#cb45-176" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(naissance, mon_df, <span class="at">file =</span> <span class="st">"naissance_mon_df.Rdata"</span>)</span>
<span id="cb45-177"><a href="#cb45-177" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(naissance, mon_df)</span>
<span id="cb45-178"><a href="#cb45-178" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(mon_df)</span>
<span id="cb45-179"><a href="#cb45-179" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"naissance_mon_df.Rdata"</span>)</span>
<span id="cb45-180"><a href="#cb45-180" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(mon_df)</span>
<span id="cb45-181"><a href="#cb45-181" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-182"><a href="#cb45-182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-183"><a href="#cb45-183" aria-hidden="true" tabindex="-1"></a>Ce comportement est pratique, mais peut parfois s'avérer trompeur. Si on a</span>
<span id="cb45-184"><a href="#cb45-184" aria-hidden="true" tabindex="-1"></a>beaucoup d'objets dans notre environnement, et qu'on charge un objet</span>
<span id="cb45-185"><a href="#cb45-185" aria-hidden="true" tabindex="-1"></a><span class="in">`.Rdata`</span> avec plusieurs objets (dont on ne se souvient pas, ou dont on ne connaît pas le nom), il est difficile de s'y retrouver. De plus, lors du chargement, <span class="in">`r fontawesome::fa('r-project')`</span> peut écraser des objets déjà présents avec le même nom.  </span>
<span id="cb45-186"><a href="#cb45-186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-187"><a href="#cb45-187" aria-hidden="true" tabindex="-1"></a>**Conseil** : mettre tout ce qu'on veut sauver dans une liste, et sauver cette</span>
<span id="cb45-188"><a href="#cb45-188" aria-hidden="true" tabindex="-1"></a>liste sous format <span class="in">`.Rdata`</span> en gardant le même nom :</span>
<span id="cb45-189"><a href="#cb45-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-190"><a href="#cb45-190" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, include=TRUE}</span></span>
<span id="cb45-191"><a href="#cb45-191" aria-hidden="true" tabindex="-1"></a>naissance_mon_df <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">"naissance"</span> <span class="ot">=</span> naissance, <span class="st">"mon_df"</span> <span class="ot">=</span> mon_df)</span>
<span id="cb45-192"><a href="#cb45-192" aria-hidden="true" tabindex="-1"></a><span class="fu">save</span>(naissance_mon_df, <span class="at">file =</span> <span class="st">"naissance_mon_df.Rdata"</span>)</span>
<span id="cb45-193"><a href="#cb45-193" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(naissance_mon_df)</span>
<span id="cb45-194"><a href="#cb45-194" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"naissance_mon_df.Rdata"</span>)</span>
<span id="cb45-195"><a href="#cb45-195" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-196"><a href="#cb45-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-197"><a href="#cb45-197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-198"><a href="#cb45-198" aria-hidden="true" tabindex="-1"></a><span class="fu">## Opérations sur les tableaux de données</span></span>
<span id="cb45-199"><a href="#cb45-199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-200"><a href="#cb45-200" aria-hidden="true" tabindex="-1"></a><span class="fu">### Sélection, suppression, ajout</span></span>
<span id="cb45-201"><a href="#cb45-201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-202"><a href="#cb45-202" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Exercice 1 : Sélection de colonnes</span></span>
<span id="cb45-203"><a href="#cb45-203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-204"><a href="#cb45-204" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>J'ai dénombré 10 façons de sélectionner la variable <span class="in">`AGE`</span>. En gardant en tête</span>
<span id="cb45-205"><a href="#cb45-205" aria-hidden="true" tabindex="-1"></a>qu'un <span class="in">`data.frame`</span> est une liste de colonnes, essayer d'en trouver un maximum.</span>
<span id="cb45-206"><a href="#cb45-206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-209"><a href="#cb45-209" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb45-210"><a href="#cb45-210" aria-hidden="true" tabindex="-1"></a><span class="co"># Pour sélectionner une colonne, on peut utiliser l'aspect "liste" du `data.frame`, avec le `$`</span></span>
<span id="cb45-211"><a href="#cb45-211" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(naissance<span class="sc">$</span>AGE)</span>
<span id="cb45-212"><a href="#cb45-212" aria-hidden="true" tabindex="-1"></a><span class="fu">typeof</span>(naissance<span class="sc">$</span>AGE)</span>
<span id="cb45-213"><a href="#cb45-213" aria-hidden="true" tabindex="-1"></a><span class="co"># Le `$` extrait la composante de la liste `naissance` nommée `AGE`.</span></span>
<span id="cb45-214"><a href="#cb45-214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-215"><a href="#cb45-215" aria-hidden="true" tabindex="-1"></a><span class="co"># Toujours côté "liste", on peut également utiliser le `[[]]`, qui exécute la même opération, et qui peut s'utiliser avec le numéro de la variable à la place du nom :</span></span>
<span id="cb45-216"><a href="#cb45-216" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(naissance[[<span class="dv">2</span>]])</span>
<span id="cb45-217"><a href="#cb45-217" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(naissance[[<span class="st">"AGE"</span>]])</span>
<span id="cb45-218"><a href="#cb45-218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-219"><a href="#cb45-219" aria-hidden="true" tabindex="-1"></a><span class="co"># Dernière façon "liste", utiliser le `[]`, car une liste est un vecteur :</span></span>
<span id="cb45-220"><a href="#cb45-220" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(naissance[<span class="dv">2</span>])</span>
<span id="cb45-221"><a href="#cb45-221" aria-hidden="true" tabindex="-1"></a><span class="fu">typeof</span>(naissance[<span class="dv">2</span>])</span>
<span id="cb45-222"><a href="#cb45-222" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(naissance[<span class="st">"AGE"</span>])</span>
<span id="cb45-223"><a href="#cb45-223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-224"><a href="#cb45-224" aria-hidden="true" tabindex="-1"></a><span class="co"># Nous voyons, que contrairement à avant où nous avions extrait un vecteur, nous avons ici extrait un sous-dataframe (ou encore une sous-liste). Ce dernier point est important à garder en tête, car il peut être source de nombreux bugs...</span></span>
<span id="cb45-225"><a href="#cb45-225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-226"><a href="#cb45-226" aria-hidden="true" tabindex="-1"></a><span class="co"># On peut aussi utiliser le côté "matrice" du dataframe, avec le `[,]` :</span></span>
<span id="cb45-227"><a href="#cb45-227" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(naissance[, <span class="dv">2</span>])</span>
<span id="cb45-228"><a href="#cb45-228" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(naissance[, <span class="st">"AGE"</span>])</span>
<span id="cb45-229"><a href="#cb45-229" aria-hidden="true" tabindex="-1"></a><span class="co"># Ici nous avons extrait la colonne numéro 2 de la "matrice". Par contre, **ce n'est plus un dataframe !**</span></span>
<span id="cb45-230"><a href="#cb45-230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-231"><a href="#cb45-231" aria-hidden="true" tabindex="-1"></a><span class="co"># Si on souhaite garder la structure de dataframe, il faut rajouter l'option `drop = FALSE` :</span></span>
<span id="cb45-232"><a href="#cb45-232" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(naissance[, <span class="dv">2</span>, <span class="at">drop =</span> <span class="cn">FALSE</span>])</span>
<span id="cb45-233"><a href="#cb45-233" aria-hidden="true" tabindex="-1"></a><span class="co">#!!! </span><span class="al">ATTENTION</span><span class="co"> : Ce comportement est connu comme étant une source d'erreurs fréquente dans R quand on programme ses propres fonctions !!!**</span></span>
<span id="cb45-234"><a href="#cb45-234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-235"><a href="#cb45-235" aria-hidden="true" tabindex="-1"></a><span class="co"># Sinon, on peut utiliser la fonction `subset()` :</span></span>
<span id="cb45-236"><a href="#cb45-236" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(<span class="fu">subset</span>(naissance, <span class="at">select =</span> <span class="dv">2</span>))</span>
<span id="cb45-237"><a href="#cb45-237" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(<span class="fu">subset</span>(naissance, <span class="at">select =</span> <span class="st">"AGE"</span>))</span>
<span id="cb45-238"><a href="#cb45-238" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(<span class="fu">subset</span>(naissance, <span class="at">select =</span> AGE))</span>
<span id="cb45-239"><a href="#cb45-239" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-240"><a href="#cb45-240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-241"><a href="#cb45-241" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Utiliser la fonction <span class="in">`select`</span> du package <span class="in">`dplyr`</span> pour sélectionner la</span>
<span id="cb45-242"><a href="#cb45-242" aria-hidden="true" tabindex="-1"></a>variable <span class="in">`AGE`</span> et regarder comment elle se comporte.</span>
<span id="cb45-243"><a href="#cb45-243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-246"><a href="#cb45-246" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb45-247"><a href="#cb45-247" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(dplyr<span class="sc">::</span><span class="fu">select</span>(naissance, <span class="dv">2</span>))</span>
<span id="cb45-248"><a href="#cb45-248" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(dplyr<span class="sc">::</span><span class="fu">select</span>(naissance, AGE))</span>
<span id="cb45-249"><a href="#cb45-249" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-250"><a href="#cb45-250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-251"><a href="#cb45-251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-252"><a href="#cb45-252" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Exercice 2 : Sélection de plusieurs colonnes</span></span>
<span id="cb45-253"><a href="#cb45-253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-254"><a href="#cb45-254" aria-hidden="true" tabindex="-1"></a>Essayer tous les commandes précédentes pour extraire, en même temps, </span>
<span id="cb45-255"><a href="#cb45-255" aria-hidden="true" tabindex="-1"></a>les 4 colonnes <span class="in">`ID`</span>, <span class="in">`AGE`</span>, <span class="in">`LWT`</span> et <span class="in">`SMOKE`</span>.</span>
<span id="cb45-256"><a href="#cb45-256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-257"><a href="#cb45-257" aria-hidden="true" tabindex="-1"></a><span class="in">```{r 4columns, results='hide'}</span></span>
<span id="cb45-258"><a href="#cb45-258" aria-hidden="true" tabindex="-1"></a><span class="co">#naissance$c("ID", "AGE", "LWT", "SMOKE")</span></span>
<span id="cb45-259"><a href="#cb45-259" aria-hidden="true" tabindex="-1"></a><span class="co">#naissance[[c(1:3, 5)]]</span></span>
<span id="cb45-260"><a href="#cb45-260" aria-hidden="true" tabindex="-1"></a><span class="co">#naissance[[c("ID", "AGE", "LWT", "SMOKE")]]</span></span>
<span id="cb45-261"><a href="#cb45-261" aria-hidden="true" tabindex="-1"></a>naissance[<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="dv">5</span>)]</span>
<span id="cb45-262"><a href="#cb45-262" aria-hidden="true" tabindex="-1"></a>naissance[<span class="fu">c</span>(<span class="st">"ID"</span>, <span class="st">"AGE"</span>, <span class="st">"LWT"</span>, <span class="st">"SMOKE"</span>)]</span>
<span id="cb45-263"><a href="#cb45-263" aria-hidden="true" tabindex="-1"></a>naissance[,<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="dv">5</span>)]</span>
<span id="cb45-264"><a href="#cb45-264" aria-hidden="true" tabindex="-1"></a>naissance[, <span class="fu">c</span>(<span class="st">"ID"</span>, <span class="st">"AGE"</span>, <span class="st">"LWT"</span>, <span class="st">"SMOKE"</span>)]</span>
<span id="cb45-265"><a href="#cb45-265" aria-hidden="true" tabindex="-1"></a><span class="fu">subset</span>(naissance, <span class="at">select =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="dv">5</span>))</span>
<span id="cb45-266"><a href="#cb45-266" aria-hidden="true" tabindex="-1"></a><span class="fu">subset</span>(naissance, <span class="at">select =</span> <span class="fu">c</span>(<span class="st">"ID"</span>, <span class="st">"AGE"</span>, <span class="st">"LWT"</span>, <span class="st">"SMOKE"</span>))</span>
<span id="cb45-267"><a href="#cb45-267" aria-hidden="true" tabindex="-1"></a><span class="fu">subset</span>(naissance, <span class="at">select =</span> <span class="fu">c</span>(ID, AGE, LWT, SMOKE))</span>
<span id="cb45-268"><a href="#cb45-268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-269"><a href="#cb45-269" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">select</span>(naissance, ID, AGE, LWT, SMOKE)</span>
<span id="cb45-270"><a href="#cb45-270" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-271"><a href="#cb45-271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-272"><a href="#cb45-272" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Exercice 3 : Sélection de lignes</span></span>
<span id="cb45-273"><a href="#cb45-273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-274"><a href="#cb45-274" aria-hidden="true" tabindex="-1"></a>Sélectionner les 5 premières lignes, puis les 5 dernières lignes (en 2</span>
<span id="cb45-275"><a href="#cb45-275" aria-hidden="true" tabindex="-1"></a>commandes) en utilisant une commande de base puis la fonction <span class="in">`dplyr::slice()`</span>. Afficher le résultat dans une *jolie* table grâce à la fonction <span class="in">`kable()`</span>du package <span class="in">`knitr`</span>.</span>
<span id="cb45-276"><a href="#cb45-276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-279"><a href="#cb45-279" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb45-280"><a href="#cb45-280" aria-hidden="true" tabindex="-1"></a><span class="co"># En ce qui concerne les lignes, nous sommes obligés de considérer l'aspect "matrice" du dataframe :</span></span>
<span id="cb45-281"><a href="#cb45-281" aria-hidden="true" tabindex="-1"></a>premiers <span class="ot">&lt;-</span> naissance[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,]</span>
<span id="cb45-282"><a href="#cb45-282" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(naissance)</span>
<span id="cb45-283"><a href="#cb45-283" aria-hidden="true" tabindex="-1"></a>derniers <span class="ot">&lt;-</span> naissance[(n<span class="dv">-5</span>)<span class="sc">:</span>n,]</span>
<span id="cb45-284"><a href="#cb45-284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-285"><a href="#cb45-285" aria-hidden="true" tabindex="-1"></a><span class="co"># Avec la fonction `dplyr::slice()` :</span></span>
<span id="cb45-286"><a href="#cb45-286" aria-hidden="true" tabindex="-1"></a>prems <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">slice</span>(naissance, <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)</span>
<span id="cb45-287"><a href="#cb45-287" aria-hidden="true" tabindex="-1"></a>derns <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">slice</span>(naissance, (<span class="fu">n</span>()<span class="sc">-</span><span class="dv">5</span>)<span class="sc">:</span>n)</span>
<span id="cb45-288"><a href="#cb45-288" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(dplyr<span class="sc">::</span><span class="fu">slice</span>(naissance, <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="fu">nrow</span>(naissance)<span class="sc">-</span><span class="dv">4</span><span class="sc">:</span><span class="dv">0</span>)))</span>
<span id="cb45-289"><a href="#cb45-289" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-290"><a href="#cb45-290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-291"><a href="#cb45-291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-292"><a href="#cb45-292" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Exercice 4 : Filtre</span></span>
<span id="cb45-293"><a href="#cb45-293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-294"><a href="#cb45-294" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Construire un sous-dataframe ne contenant que les individus fumeurs, en</span>
<span id="cb45-295"><a href="#cb45-295" aria-hidden="true" tabindex="-1"></a>utilisant <span class="in">`[,]`</span>, puis <span class="in">`subset()`</span>, et enfin <span class="in">`dplyr::filter()`</span>.</span>
<span id="cb45-296"><a href="#cb45-296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-299"><a href="#cb45-299" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb45-300"><a href="#cb45-300" aria-hidden="true" tabindex="-1"></a>fum <span class="ot">&lt;-</span> naissance[naissance<span class="sc">$</span>SMOKE <span class="sc">==</span> <span class="st">"Fumeur"</span>, ]</span>
<span id="cb45-301"><a href="#cb45-301" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(fum)</span>
<span id="cb45-302"><a href="#cb45-302" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fum<span class="sc">$</span>SMOKE)</span>
<span id="cb45-303"><a href="#cb45-303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-304"><a href="#cb45-304" aria-hidden="true" tabindex="-1"></a><span class="co">#La table `fum` ne contient que les individus fumeurs. On peut aussi utiliser la fonction `which()`, qui renvoie les indices des individus qui vérifient la condition :</span></span>
<span id="cb45-305"><a href="#cb45-305" aria-hidden="true" tabindex="-1"></a>ind_fum <span class="ot">&lt;-</span> <span class="fu">which</span>(naissance<span class="sc">$</span>SMOKE <span class="sc">==</span> <span class="st">"Fumeur"</span>)</span>
<span id="cb45-306"><a href="#cb45-306" aria-hidden="true" tabindex="-1"></a>ind_fum</span>
<span id="cb45-307"><a href="#cb45-307" aria-hidden="true" tabindex="-1"></a>fum2 <span class="ot">&lt;-</span> naissance[ind_fum,]</span>
<span id="cb45-308"><a href="#cb45-308" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(fum2)</span>
<span id="cb45-309"><a href="#cb45-309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-310"><a href="#cb45-310" aria-hidden="true" tabindex="-1"></a><span class="co"># Avec `subset()`</span></span>
<span id="cb45-311"><a href="#cb45-311" aria-hidden="true" tabindex="-1"></a>fum_sub <span class="ot">&lt;-</span> <span class="fu">subset</span>(naissance, SMOKE <span class="sc">==</span> <span class="st">"Fumeur"</span>)</span>
<span id="cb45-312"><a href="#cb45-312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-313"><a href="#cb45-313" aria-hidden="true" tabindex="-1"></a><span class="co"># Avec `dplyr::filter()` :</span></span>
<span id="cb45-314"><a href="#cb45-314" aria-hidden="true" tabindex="-1"></a>fum_fil <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(naissance, SMOKE <span class="sc">==</span> <span class="st">"Fumeur"</span>)</span>
<span id="cb45-315"><a href="#cb45-315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-316"><a href="#cb45-316" aria-hidden="true" tabindex="-1"></a><span class="co">#Les deux syntaxes ici sont identiques. La différence est que dans dplyr il y a deux fonctions (`select()` et `filter()`) avec une syntaxe très simple.</span></span>
<span id="cb45-317"><a href="#cb45-317" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-318"><a href="#cb45-318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-319"><a href="#cb45-319" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Donner les identifiants (colonne <span class="in">`ID`</span>) des individus des individus présentant de l'hypertension (variable <span class="in">`HT`</span> valant 1).</span>
<span id="cb45-320"><a href="#cb45-320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-323"><a href="#cb45-323" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb45-324"><a href="#cb45-324" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">select</span>(dplyr<span class="sc">::</span><span class="fu">filter</span>(naissance, HT <span class="sc">==</span> <span class="dv">1</span>), <span class="st">"ID"</span>)</span>
<span id="cb45-325"><a href="#cb45-325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-326"><a href="#cb45-326" aria-hidden="true" tabindex="-1"></a><span class="co"># avec le pipe :</span></span>
<span id="cb45-327"><a href="#cb45-327" aria-hidden="true" tabindex="-1"></a>naissance <span class="sc">%&gt;%</span></span>
<span id="cb45-328"><a href="#cb45-328" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(HT <span class="sc">==</span><span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb45-329"><a href="#cb45-329" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="st">"ID"</span>)</span>
<span id="cb45-330"><a href="#cb45-330" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-331"><a href="#cb45-331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-332"><a href="#cb45-332" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>Sélectionner le sous-dataframe ne contenant que les individus fumeurs et âgés de moins de 20 ans.</span>
<span id="cb45-333"><a href="#cb45-333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-336"><a href="#cb45-336" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb45-337"><a href="#cb45-337" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">filter</span>(naissance, SMOKE <span class="sc">==</span> <span class="st">"Fumeur"</span>, AGE <span class="sc">&lt;</span> <span class="dv">20</span>)</span>
<span id="cb45-338"><a href="#cb45-338" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-339"><a href="#cb45-339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-340"><a href="#cb45-340" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>Donner les indices des individus ayant un poids inférieur à 110 (le poids de la mère est en livres) ou ayant un bébé de poids inférieur à 2,5 kg.</span>
<span id="cb45-341"><a href="#cb45-341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-344"><a href="#cb45-344" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb45-345"><a href="#cb45-345" aria-hidden="true" tabindex="-1"></a>naissance <span class="sc">%&gt;%</span></span>
<span id="cb45-346"><a href="#cb45-346" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(LWT <span class="sc">&lt;</span> <span class="dv">110</span> <span class="sc">|</span> BWT <span class="sc">&lt;</span> <span class="dv">2500</span>) <span class="sc">%&gt;%</span></span>
<span id="cb45-347"><a href="#cb45-347" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="st">"ID"</span>, <span class="st">"LWT"</span>, <span class="st">"BWT"</span>)</span>
<span id="cb45-348"><a href="#cb45-348" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-349"><a href="#cb45-349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-350"><a href="#cb45-350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-351"><a href="#cb45-351" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Exercice 5 : Suppression de lignes ou de colonnes</span></span>
<span id="cb45-352"><a href="#cb45-352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-353"><a href="#cb45-353" aria-hidden="true" tabindex="-1"></a>En essayant avec <span class="in">`[,]`</span>, <span class="in">`subset()`</span> et les fonctions de <span class="in">`dplyr`</span> :</span>
<span id="cb45-354"><a href="#cb45-354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-355"><a href="#cb45-355" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Supprimer la première ligne du jeu de données.</span>
<span id="cb45-356"><a href="#cb45-356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-357"><a href="#cb45-357" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Supprimer les colonnes "AGE", "LWT", "RACE", "BWT".</span>
<span id="cb45-358"><a href="#cb45-358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-359"><a href="#cb45-359" aria-hidden="true" tabindex="-1"></a>*Indice : utiliser la même syntaxe que pour la sélection mais avec le signe `-` pour indiquer les éléments à supprimer...*</span>
<span id="cb45-360"><a href="#cb45-360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-363"><a href="#cb45-363" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb45-364"><a href="#cb45-364" aria-hidden="true" tabindex="-1"></a><span class="co"># Pour supprimer des lignes ou des colonnes, on peut utiliser `[,]` :</span></span>
<span id="cb45-365"><a href="#cb45-365" aria-hidden="true" tabindex="-1"></a>naissance_sans_ind1 <span class="ot">&lt;-</span> naissance[<span class="sc">-</span><span class="dv">1</span>, ]</span>
<span id="cb45-366"><a href="#cb45-366" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(naissance_sans_ind1)</span>
<span id="cb45-367"><a href="#cb45-367" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-368"><a href="#cb45-368" aria-hidden="true" tabindex="-1"></a>naissance_suppr_cro <span class="ot">&lt;-</span> naissance[, <span class="sc">-</span><span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>, <span class="dv">10</span>)]</span>
<span id="cb45-369"><a href="#cb45-369" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(naissance_suppr_cro)</span>
<span id="cb45-370"><a href="#cb45-370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-371"><a href="#cb45-371" aria-hidden="true" tabindex="-1"></a><span class="co">#naissance_sans_AGE &lt;- naissance[, -c("AGE", "LWT", "RACE", "BWT")]</span></span>
<span id="cb45-372"><a href="#cb45-372" aria-hidden="true" tabindex="-1"></a><span class="co"># Cette dernière opération n'est pas possible.</span></span>
<span id="cb45-373"><a href="#cb45-373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-374"><a href="#cb45-374" aria-hidden="true" tabindex="-1"></a><span class="co"># Là encore, les fonctions `subset()` et `select()` permettent plus d'opérations avec une syntaxe très simple :</span></span>
<span id="cb45-375"><a href="#cb45-375" aria-hidden="true" tabindex="-1"></a>naissance_suprr_sub <span class="ot">&lt;-</span> <span class="fu">subset</span>(naissance, <span class="at">select =</span> <span class="sc">-</span><span class="fu">c</span>(AGE<span class="sc">:</span>RACE, BWT))</span>
<span id="cb45-376"><a href="#cb45-376" aria-hidden="true" tabindex="-1"></a>naissance_suprr_sel <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">select</span>(naissance, <span class="sc">-</span><span class="fu">c</span>(AGE<span class="sc">:</span>RACE, BWT))</span>
<span id="cb45-377"><a href="#cb45-377" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-378"><a href="#cb45-378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-379"><a href="#cb45-379" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Exercice 6 : Ajout de lignes ou de colonnes</span></span>
<span id="cb45-380"><a href="#cb45-380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-381"><a href="#cb45-381" aria-hidden="true" tabindex="-1"></a>Ajouter un une ligne (un individu) possédant les valeurs suivantes :</span>
<span id="cb45-382"><a href="#cb45-382" aria-hidden="true" tabindex="-1"></a><span class="in">`1, 20, 143, 2, "Non-Fumeur", 0, 0, 0, 0, 2500`</span></span>
<span id="cb45-383"><a href="#cb45-383" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-386"><a href="#cb45-386" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb45-387"><a href="#cb45-387" aria-hidden="true" tabindex="-1"></a>naissance[<span class="fu">nrow</span>(naissance) <span class="sc">+</span> <span class="dv">1</span>, ] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">20</span>, <span class="dv">143</span>, <span class="dv">2</span>, <span class="st">"Non-Fumeur"</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">2500</span>)</span>
<span id="cb45-388"><a href="#cb45-388" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(naissance)</span>
<span id="cb45-389"><a href="#cb45-389" aria-hidden="true" tabindex="-1"></a><span class="co"># Apparemment tout va bien...</span></span>
<span id="cb45-390"><a href="#cb45-390" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(naissance)</span>
<span id="cb45-391"><a href="#cb45-391" aria-hidden="true" tabindex="-1"></a><span class="co"># Mais on vient en fait de casser notre jeu de données...</span></span>
<span id="cb45-392"><a href="#cb45-392" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-393"><a href="#cb45-393" aria-hidden="true" tabindex="-1"></a>naissance <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="st">"naissance.txt"</span>)</span>
<span id="cb45-394"><a href="#cb45-394" aria-hidden="true" tabindex="-1"></a>naissance<span class="sc">$</span>SMOKE <span class="ot">&lt;-</span> <span class="fu">factor</span>(naissance<span class="sc">$</span>SMOKE, <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Non-Fumeur"</span>, <span class="st">"Fumeur"</span>))</span>
<span id="cb45-395"><a href="#cb45-395" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-396"><a href="#cb45-396" aria-hidden="true" tabindex="-1"></a>naissance[<span class="fu">nrow</span>(naissance) <span class="sc">+</span> <span class="dv">1</span>, ] <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="dv">1</span>, <span class="dv">20</span>, <span class="dv">143</span>, <span class="dv">2</span>, <span class="st">"Non-Fumeur"</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">2500</span>)</span>
<span id="cb45-397"><a href="#cb45-397" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(naissance)</span>
<span id="cb45-398"><a href="#cb45-398" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(naissance)</span>
<span id="cb45-399"><a href="#cb45-399" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-400"><a href="#cb45-400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-401"><a href="#cb45-401" aria-hidden="true" tabindex="-1"></a>**NB**: On peut rajouter une colonne (une variable), à l'aide de <span class="in">`$`</span>, <span class="in">`transform()`</span> ou <span class="in">`mutate()`</span> (comme vu précédemment).</span>
<span id="cb45-402"><a href="#cb45-402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-403"><a href="#cb45-403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-404"><a href="#cb45-404" aria-hidden="true" tabindex="-1"></a><span class="fu">### Fusion</span></span>
<span id="cb45-405"><a href="#cb45-405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-406"><a href="#cb45-406" aria-hidden="true" tabindex="-1"></a>La fonction <span class="in">`merge()`</span> permet de fusionner deux tableaux de données :</span>
<span id="cb45-407"><a href="#cb45-407" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-408"><a href="#cb45-408" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, include=TRUE}</span></span>
<span id="cb45-409"><a href="#cb45-409" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(naissance)</span>
<span id="cb45-410"><a href="#cb45-410" aria-hidden="true" tabindex="-1"></a>nais1 <span class="ot">&lt;-</span> naissance[,<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>]</span>
<span id="cb45-411"><a href="#cb45-411" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(nais1)</span>
<span id="cb45-412"><a href="#cb45-412" aria-hidden="true" tabindex="-1"></a>nais2 <span class="ot">&lt;-</span> naissance[,<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">7</span><span class="sc">:</span><span class="dv">10</span>)]</span>
<span id="cb45-413"><a href="#cb45-413" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(nais2)</span>
<span id="cb45-414"><a href="#cb45-414" aria-hidden="true" tabindex="-1"></a>nais_fus1 <span class="ot">&lt;-</span> <span class="fu">merge</span>(nais1, nais2)</span>
<span id="cb45-415"><a href="#cb45-415" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(nais_fus1)</span>
<span id="cb45-416"><a href="#cb45-416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-417"><a href="#cb45-417" aria-hidden="true" tabindex="-1"></a><span class="co"># Ici, vu que les individus sont dans le même ordre on aurait pu utiliser la fonction cbind(), et la colonne ID n'est pas utile :</span></span>
<span id="cb45-418"><a href="#cb45-418" aria-hidden="true" tabindex="-1"></a>nais_fus2 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(nais1, nais2[, <span class="sc">-</span><span class="dv">1</span>])</span>
<span id="cb45-419"><a href="#cb45-419" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(nais_fus2)</span>
<span id="cb45-420"><a href="#cb45-420" aria-hidden="true" tabindex="-1"></a><span class="fu">identical</span>(nais_fus1, nais_fus2)</span>
<span id="cb45-421"><a href="#cb45-421" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-422"><a href="#cb45-422" aria-hidden="true" tabindex="-1"></a><span class="co"># Les deux dataframes ne sont pas identitiques, car merge a classé par ordre croissant suivant la variable de regroupement ID, mais les informations sont les mêmes.</span></span>
<span id="cb45-423"><a href="#cb45-423" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-424"><a href="#cb45-424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-425"><a href="#cb45-425" aria-hidden="true" tabindex="-1"></a>On peut également fusionner deux tableaux de données où les individus</span>
<span id="cb45-426"><a href="#cb45-426" aria-hidden="true" tabindex="-1"></a>(qui doivent être les mêmes) ne sont pas dans le même ordre :</span>
<span id="cb45-427"><a href="#cb45-427" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-428"><a href="#cb45-428" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, include=TRUE}</span></span>
<span id="cb45-429"><a href="#cb45-429" aria-hidden="true" tabindex="-1"></a>desordre <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(naissance), <span class="fu">nrow</span>(naissance))</span>
<span id="cb45-430"><a href="#cb45-430" aria-hidden="true" tabindex="-1"></a>nais3 <span class="ot">&lt;-</span> naissance[desordre, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">7</span><span class="sc">:</span><span class="dv">10</span>)]</span>
<span id="cb45-431"><a href="#cb45-431" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(nais3)</span>
<span id="cb45-432"><a href="#cb45-432" aria-hidden="true" tabindex="-1"></a>nais_fus3 <span class="ot">&lt;-</span> <span class="fu">merge</span>(nais1, nais3)</span>
<span id="cb45-433"><a href="#cb45-433" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(nais_fus3)</span>
<span id="cb45-434"><a href="#cb45-434" aria-hidden="true" tabindex="-1"></a><span class="fu">identical</span>(nais_fus1, nais_fus3)</span>
<span id="cb45-435"><a href="#cb45-435" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-436"><a href="#cb45-436" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-437"><a href="#cb45-437" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-438"><a href="#cb45-438" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Exercice 7 : join</span></span>
<span id="cb45-439"><a href="#cb45-439" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-440"><a href="#cb45-440" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Consulter l'aide de <span class="in">`dplyr::sample_n`</span> et trouver un moyens simple de permuter</span>
<span id="cb45-441"><a href="#cb45-441" aria-hidden="true" tabindex="-1"></a>les lignes du jeu de données.</span>
<span id="cb45-442"><a href="#cb45-442" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-445"><a href="#cb45-445" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb45-446"><a href="#cb45-446" aria-hidden="true" tabindex="-1"></a>naissance_perm <span class="ot">&lt;-</span> <span class="fu">sample_n</span>(naissance, <span class="at">size =</span> <span class="fu">nrow</span>(naissance))</span>
<span id="cb45-447"><a href="#cb45-447" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(naissance_perm))</span>
<span id="cb45-448"><a href="#cb45-448" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(naissance))</span>
<span id="cb45-449"><a href="#cb45-449" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-450"><a href="#cb45-450" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-451"><a href="#cb45-451" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Consulter l'aide de <span class="in">`dplyr::join()`</span> (pour plus d'informations sur les fusions</span>
<span id="cb45-452"><a href="#cb45-452" aria-hidden="true" tabindex="-1"></a>avec <span class="in">`dplyr`</span> consulter cette <span class="co">[</span><span class="ot">page</span><span class="co">](https://cran.rstudio.com/web/packages/dplyr/vignettes/two-table.html)</span>),</span>
<span id="cb45-453"><a href="#cb45-453" aria-hidden="true" tabindex="-1"></a>puis utiliser la fonction <span class="in">`dplyr::left_join()`</span> pour fusionner les tables <span class="in">`nais1`</span></span>
<span id="cb45-454"><a href="#cb45-454" aria-hidden="true" tabindex="-1"></a>et <span class="in">`nais3`</span>.</span>
<span id="cb45-455"><a href="#cb45-455" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-458"><a href="#cb45-458" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb45-459"><a href="#cb45-459" aria-hidden="true" tabindex="-1"></a>nais_joined <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">left_join</span>(nais1, nais3, <span class="at">by=</span><span class="st">"ID"</span>)</span>
<span id="cb45-460"><a href="#cb45-460" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(nais_joined))</span>
<span id="cb45-461"><a href="#cb45-461" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-462"><a href="#cb45-462" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-463"><a href="#cb45-463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-464"><a href="#cb45-464" aria-hidden="true" tabindex="-1"></a><span class="fu">### Trier un tableau de données le long d'une colonne</span></span>
<span id="cb45-465"><a href="#cb45-465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-466"><a href="#cb45-466" aria-hidden="true" tabindex="-1"></a>Pour trier le tableau suivant la variable <span class="in">`ID`</span> par ordre croissant, on utilise la fonction <span class="in">`order()`</span> :</span>
<span id="cb45-467"><a href="#cb45-467" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-468"><a href="#cb45-468" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, include=TRUE}</span></span>
<span id="cb45-469"><a href="#cb45-469" aria-hidden="true" tabindex="-1"></a>nais_orderID <span class="ot">&lt;-</span> naissance[<span class="fu">order</span>(naissance<span class="sc">$</span>ID), ]</span>
<span id="cb45-470"><a href="#cb45-470" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(nais_orderID))</span>
<span id="cb45-471"><a href="#cb45-471" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-472"><a href="#cb45-472" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-473"><a href="#cb45-473" aria-hidden="true" tabindex="-1"></a>Maintenant, si on veut trier le tableau suivant l'âge par ordre décroissant :</span>
<span id="cb45-474"><a href="#cb45-474" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-475"><a href="#cb45-475" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, include=TRUE}</span></span>
<span id="cb45-476"><a href="#cb45-476" aria-hidden="true" tabindex="-1"></a>nais_decAGE <span class="ot">&lt;-</span> naissance[<span class="fu">order</span>(naissance<span class="sc">$</span>AGE, <span class="at">decreasing =</span> <span class="cn">TRUE</span>), ]</span>
<span id="cb45-477"><a href="#cb45-477" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(nais_decAGE[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, ])</span>
<span id="cb45-478"><a href="#cb45-478" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-479"><a href="#cb45-479" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-480"><a href="#cb45-480" aria-hidden="true" tabindex="-1"></a>On remarque qu'il y a des ex-aequo. On peut rajouter une variable sur laquelle trier les ex-aequo, en deuxième argument de <span class="in">`order()`</span> :</span>
<span id="cb45-481"><a href="#cb45-481" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-482"><a href="#cb45-482" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, include=TRUE}</span></span>
<span id="cb45-483"><a href="#cb45-483" aria-hidden="true" tabindex="-1"></a>nais_decAGE_decLWT <span class="ot">&lt;-</span> naissance[<span class="fu">order</span>(naissance<span class="sc">$</span>AGE, naissance<span class="sc">$</span>LWT, <span class="at">decreasing =</span> <span class="cn">TRUE</span>), ]</span>
<span id="cb45-484"><a href="#cb45-484" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(nais_decAGE_decLWT[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, ])</span>
<span id="cb45-485"><a href="#cb45-485" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-486"><a href="#cb45-486" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-487"><a href="#cb45-487" aria-hidden="true" tabindex="-1"></a>Enfin, si on veut que le classement soit fait de façon croissante sur <span class="in">`LWT`</span>, on peut procéder de la façon suivante :</span>
<span id="cb45-488"><a href="#cb45-488" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-489"><a href="#cb45-489" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, include=TRUE}</span></span>
<span id="cb45-490"><a href="#cb45-490" aria-hidden="true" tabindex="-1"></a>nais_decAGE_LWT <span class="ot">&lt;-</span> naissance[<span class="fu">order</span>(naissance<span class="sc">$</span>AGE, <span class="sc">-</span>naissance<span class="sc">$</span>LWT, <span class="at">decreasing =</span> <span class="cn">TRUE</span>), ]</span>
<span id="cb45-491"><a href="#cb45-491" aria-hidden="true" tabindex="-1"></a>nais_decAGE_LWT[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, ]</span>
<span id="cb45-492"><a href="#cb45-492" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-493"><a href="#cb45-493" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-494"><a href="#cb45-494" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Exercice 8 : `dplyr::arrange()`</span></span>
<span id="cb45-495"><a href="#cb45-495" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-496"><a href="#cb45-496" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Utiliser la fonction <span class="in">`dplyr::arrange()`</span> pour reproduire les tris précédents.</span>
<span id="cb45-497"><a href="#cb45-497" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-498"><a href="#cb45-498" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Trier le dataframe suivant la variable <span class="in">`SMOKE`</span> (qui est un facteur). Comment R choisit-il pour déterminer quelle modalité du facteur va apparaître en premier ?</span>
<span id="cb45-499"><a href="#cb45-499" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-500"><a href="#cb45-500" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>Rajouter une variable, nommée <span class="in">`lettre`</span> au dataframe, contenant des lettres majuscules choisies alétoirement. On peut utiliser <span class="in">`sample(letters, nrow(naissance), replace = TRUE)`</span> pour générer ce tirage aléatoire.</span>
<span id="cb45-501"><a href="#cb45-501" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-502"><a href="#cb45-502" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>Trier le dataframe suivant la nouvelle variable <span class="in">`lettre`</span>.</span>
<span id="cb45-503"><a href="#cb45-503" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-504"><a href="#cb45-504" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-505"><a href="#cb45-505" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-506"><a href="#cb45-506" aria-hidden="true" tabindex="-1"></a><span class="fu">### La classe `tlb`</span></span>
<span id="cb45-507"><a href="#cb45-507" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-508"><a href="#cb45-508" aria-hidden="true" tabindex="-1"></a>Le package s'appuie sur une nouvelle classe d'objets : <span class="in">`tbl`</span>. </span>
<span id="cb45-509"><a href="#cb45-509" aria-hidden="true" tabindex="-1"></a>Le résultat affiché lorsqu'on tape le nom du tableau est tronqué </span>
<span id="cb45-510"><a href="#cb45-510" aria-hidden="true" tabindex="-1"></a>pour cette nouvelle classe :</span>
<span id="cb45-511"><a href="#cb45-511" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-512"><a href="#cb45-512" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, include=TRUE}</span></span>
<span id="cb45-513"><a href="#cb45-513" aria-hidden="true" tabindex="-1"></a>nais <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(naissance)</span>
<span id="cb45-514"><a href="#cb45-514" aria-hidden="true" tabindex="-1"></a>nais</span>
<span id="cb45-515"><a href="#cb45-515" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(nais)</span>
<span id="cb45-516"><a href="#cb45-516" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-517"><a href="#cb45-517" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-518"><a href="#cb45-518" aria-hidden="true" tabindex="-1"></a>De plus, le comportement de la sélection de colonne est changé : on garde la</span>
<span id="cb45-519"><a href="#cb45-519" aria-hidden="true" tabindex="-1"></a>structure de tableau de données même lorsqu'on sélectionne une seule colonne :</span>
<span id="cb45-520"><a href="#cb45-520" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-521"><a href="#cb45-521" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, include=TRUE}</span></span>
<span id="cb45-522"><a href="#cb45-522" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(naissance[, <span class="dv">2</span>])</span>
<span id="cb45-523"><a href="#cb45-523" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(nais[, <span class="dv">2</span>])</span>
<span id="cb45-524"><a href="#cb45-524" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-525"><a href="#cb45-525" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-526"><a href="#cb45-526" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Exercice 9 : `dplyr::arrange()`</span></span>
<span id="cb45-527"><a href="#cb45-527" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-528"><a href="#cb45-528" aria-hidden="true" tabindex="-1"></a><span class="ss"> 1. </span>Utiliser la fonction<span class="in">`dplyr::arrange()`</span> pour ordonner le tableau de données naissance par age, avec les poids de naissance par ordre décroissant pour les égalités.</span>
<span id="cb45-529"><a href="#cb45-529" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-532"><a href="#cb45-532" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb45-533"><a href="#cb45-533" aria-hidden="true" tabindex="-1"></a><span class="fu">arrange</span>(naissance, AGE, <span class="fu">desc</span>(BWT))</span>
<span id="cb45-534"><a href="#cb45-534" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-535"><a href="#cb45-535" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-536"><a href="#cb45-536" aria-hidden="true" tabindex="-1"></a><span class="fu"># Introduction au pipe `%&gt;%`</span></span>
<span id="cb45-537"><a href="#cb45-537" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-538"><a href="#cb45-538" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Exercice 10</span></span>
<span id="cb45-539"><a href="#cb45-539" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-540"><a href="#cb45-540" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>À l'aide des fonctions <span class="in">`dplyr::group_by()`</span>, <span class="in">`dplyr::summarize()`</span>, <span class="in">`dplyr::n()`</span>, <span class="in">`dplyr::filter()`</span> et <span class="in">`dplyr::arrange()`</span>, construire le tableau de données donnant le poids moyen à la naissance par âge stratifié sur le statut tabagique, ainsi que le nombre d'observations correpondantes, et ordonné le résultat par ordre de poids moyen croissant en ne sélectionnant que les catéories pour lesquelles le poids moyen est inférieur à 2,5kg.</span>
<span id="cb45-543"><a href="#cb45-543" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb45-544"><a href="#cb45-544" aria-hidden="true" tabindex="-1"></a>naissance_exo10 <span class="ot">&lt;-</span> <span class="fu">group_by</span>(naissance, AGE, SMOKE)</span>
<span id="cb45-545"><a href="#cb45-545" aria-hidden="true" tabindex="-1"></a>naissance_exo10 <span class="ot">&lt;-</span> <span class="fu">summarise</span>(naissance_exo10,</span>
<span id="cb45-546"><a href="#cb45-546" aria-hidden="true" tabindex="-1"></a>  <span class="at">poids_moy =</span> <span class="fu">mean</span>(BWT, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">n =</span> <span class="fu">n</span>())</span>
<span id="cb45-547"><a href="#cb45-547" aria-hidden="true" tabindex="-1"></a>naissance_exo10 <span class="ot">&lt;-</span> <span class="fu">filter</span>(naissance_exo10, poids_moy <span class="sc">&lt;</span> <span class="dv">2500</span>)</span>
<span id="cb45-548"><a href="#cb45-548" aria-hidden="true" tabindex="-1"></a>naissance_exo10 <span class="ot">&lt;-</span> <span class="fu">arrange</span>(naissance_exo10, poids_moy)</span>
<span id="cb45-549"><a href="#cb45-549" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(naissance_exo10)</span>
<span id="cb45-550"><a href="#cb45-550" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-551"><a href="#cb45-551" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-552"><a href="#cb45-552" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Réécrire le code de la réponse précédente à l'aide de l'opérateur <span class="in">`%&gt;%`</span></span>
<span id="cb45-555"><a href="#cb45-555" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb45-556"><a href="#cb45-556" aria-hidden="true" tabindex="-1"></a>naissance_exo10_pipe <span class="ot">&lt;-</span> naissance <span class="sc">%&gt;%</span> </span>
<span id="cb45-557"><a href="#cb45-557" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(AGE, SMOKE) <span class="sc">%&gt;%</span> </span>
<span id="cb45-558"><a href="#cb45-558" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">poids_moy =</span> <span class="fu">mean</span>(BWT, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), </span>
<span id="cb45-559"><a href="#cb45-559" aria-hidden="true" tabindex="-1"></a>            <span class="at">n =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb45-560"><a href="#cb45-560" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(poids_moy <span class="sc">&lt;</span> <span class="dv">2500</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb45-561"><a href="#cb45-561" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(poids_moy)</span>
<span id="cb45-562"><a href="#cb45-562" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(naissance_exo10_pipe)</span>
<span id="cb45-563"><a href="#cb45-563" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb45-564"><a href="#cb45-564" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-565"><a href="#cb45-565" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-566"><a href="#cb45-566" aria-hidden="true" tabindex="-1"></a><span class="fu"># Résumé</span></span>
<span id="cb45-567"><a href="#cb45-567" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-568"><a href="#cb45-568" aria-hidden="true" tabindex="-1"></a>Le package <span class="in">`dplyr`</span> propose un ensemble de fonctions très simples à utiliser</span>
<span id="cb45-569"><a href="#cb45-569" aria-hidden="true" tabindex="-1"></a>et permettant de réaliser toutes les opérations classiques sur les tableaux</span>
<span id="cb45-570"><a href="#cb45-570" aria-hidden="true" tabindex="-1"></a>de données, avec une syntaxe très claire et compréhensible.</span>
<span id="cb45-571"><a href="#cb45-571" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-572"><a href="#cb45-572" aria-hidden="true" tabindex="-1"></a>Pour aller plus loin, ou voir d'autres exemples, consulter cette</span>
<span id="cb45-573"><a href="#cb45-573" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">page</span><span class="co">](https://cran.rstudio.com/web/packages/dplyr/vignettes/dplyr.html)</span>.</span>
<span id="cb45-574"><a href="#cb45-574" aria-hidden="true" tabindex="-1"></a>On renverra également vers cet </span>
<span id="cb45-575"><a href="#cb45-575" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">aide-mémoire</span><span class="co">](https://www.rstudio.com/wp-content/uploads/2016/01/data-wrangling-french.pdf)</span>.</span>
<span id="cb45-576"><a href="#cb45-576" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-577"><a href="#cb45-577" aria-hidden="true" tabindex="-1"></a>En dehors du changement de syntaxe, les gains en temps de calcul sont souvent significatifs avec <span class="in">`dplyr`</span>.</span>
<span id="cb45-578"><a href="#cb45-578" aria-hidden="true" tabindex="-1"></a>Il existe un autre package populaire pour faire des manipulations sur les</span>
<span id="cb45-579"><a href="#cb45-579" aria-hidden="true" tabindex="-1"></a>(grands) jeux de données : <span class="in">`data.table`</span>. La syntaxe est un peu moins intuitive</span>
<span id="cb45-580"><a href="#cb45-580" aria-hidden="true" tabindex="-1"></a>que <span class="in">`dplyr`</span>, mais l'efficacité est encore accrue.</span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>